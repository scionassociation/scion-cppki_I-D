<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>SCION Control-Plane PKI</title>
<meta content="Corine de Kater" name="author">
<meta content="Nicola Rustignoli" name="author">
<meta content="Samuel Hitz" name="author">
<meta content="
       This document presents the trust concept and design of the SCION  control-plane Public Key Infrastructure (PKI) , SCION's public key infrastructure model. SCION (Scalability, Control, and Isolation On Next-generation networks) is a path-aware, inter-domain network architecture. The control-plane PKI, or short CP-PKI, handles cryptographic material and lays the foundation for the authentication procedures in SCION. It is used by SCION's control plane to authenticate and verify path information, and builds the basis for SCION's special trust model based on so-called Isolation Domains. 
       This document first introduces the trust model behind the SCION's control-plane PKI, as well as clarifications to the concepts used in it. This is followed by specifications of the different types of certificates and the Trust Root Configuration. The document then specifies how to deploy the whole infrastructure. 
    " name="description">
<meta content="xml2rfc 3.23.2" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-dekater-scion-pki-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.23.2
    Python 3.12.7
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 4.9.4
    platformdirs 4.3.6
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-dekater-scion-pki.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">SCION CP-PKI</td>
<td class="right">October 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">de Kater, et al.</td>
<td class="center">Expires 12 April 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-dekater-scion-pki-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-10-09" class="published">9 October 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-04-12">12 April 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">C. de Kater</div>
<div class="org">SCION Association</div>
</div>
<div class="author">
      <div class="author-name">N. Rustignoli</div>
<div class="org">SCION Association</div>
</div>
<div class="author">
      <div class="author-name">S. Hitz</div>
<div class="org">Anapaya Systems</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">SCION Control-Plane PKI</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document presents the trust concept and design of the SCION <em>control-plane Public Key Infrastructure (PKI)</em>, SCION's public key infrastructure model. SCION (Scalability, Control, and Isolation On Next-generation networks) is a path-aware, inter-domain network architecture. The control-plane PKI, or short CP-PKI, handles cryptographic material and lays the foundation for the authentication procedures in SCION. It is used by SCION's control plane to authenticate and verify path information, and builds the basis for SCION's special trust model based on so-called Isolation Domains.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This document first introduces the trust model behind the SCION's control-plane PKI, as well as clarifications to the concepts used in it. This is followed by specifications of the different types of certificates and the Trust Root Configuration. The document then specifies how to deploy the whole infrastructure.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://scionassociation.github.io/scion-cppki_I-D/draft-dekater-scion-pki.html">https://scionassociation.github.io/scion-cppki_I-D/draft-dekater-scion-pki.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-dekater-scion-pki/">https://datatracker.ietf.org/doc/draft-dekater-scion-pki/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/scionassociation/scion-cppki_I-D">https://github.com/scionassociation/scion-cppki_I-D</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 12 April 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-trust-model" class="internal xref">Trust Model</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="auto internal xref">1.4</a>.  <a href="#name-trust-relations-within-an-i" class="internal xref">Trust Relations within an Isolation Domain</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4.2.1">
                    <p id="section-toc.1-1.1.2.4.2.1.1"><a href="#section-1.4.1" class="auto internal xref">1.4.1</a>.  <a href="#name-updates-and-trust-resets" class="internal xref">Updates and Trust Resets</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4.2.2">
                    <p id="section-toc.1-1.1.2.4.2.2.1"><a href="#section-1.4.2" class="auto internal xref">1.4.2</a>.  <a href="#name-substitutes-to-certificate-" class="internal xref">Substitutes to Certificate Revocation</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5">
                <p id="section-toc.1-1.1.2.5.1"><a href="#section-1.5" class="auto internal xref">1.5</a>.  <a href="#name-overview-of-certificates-ke" class="internal xref">Overview of Certificates, Keys, and Roles</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.6">
                <p id="section-toc.1-1.1.2.6.1"><a href="#section-1.6" class="auto internal xref">1.6</a>.  <a href="#name-trust-as-a-function" class="internal xref">Trust as a Function</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.6.2.1">
                    <p id="section-toc.1-1.1.2.6.2.1.1"><a href="#section-1.6.1" class="auto internal xref">1.6.1</a>.  <a href="#name-input" class="internal xref">Input</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.6.2.2">
                    <p id="section-toc.1-1.1.2.6.2.2.1"><a href="#section-1.6.2" class="auto internal xref">1.6.2</a>.  <a href="#name-output" class="internal xref">Output</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-certificate-specification" class="internal xref">Certificate Specification</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-scion-control-plane-pki-key" class="internal xref">SCION Control-Plane PKI Keys and Certificates - Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1"><a href="#section-2.1.1" class="auto internal xref">2.1.1</a>.  <a href="#name-trust-hierarchy" class="internal xref">Trust Hierarchy</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.2">
                    <p id="section-toc.1-1.2.2.1.2.2.1"><a href="#section-2.1.2" class="auto internal xref">2.1.2</a>.  <a href="#name-control-plane-root-certific" class="internal xref">Control-Plane Root Certificate</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.3">
                    <p id="section-toc.1-1.2.2.1.2.3.1"><a href="#section-2.1.3" class="auto internal xref">2.1.3</a>.  <a href="#name-control-plane-ca-certificat" class="internal xref">Control-Plane CA Certificate</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.4">
                    <p id="section-toc.1-1.2.2.1.2.4.1"><a href="#section-2.1.4" class="auto internal xref">2.1.4</a>.  <a href="#name-control-plane-as-certificat" class="internal xref">Control-Plane AS Certificate</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.5">
                    <p id="section-toc.1-1.2.2.1.2.5.1"><a href="#section-2.1.5" class="auto internal xref">2.1.5</a>.  <a href="#name-voting-certificates" class="internal xref">Voting Certificates</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.6">
                    <p id="section-toc.1-1.2.2.1.2.6.1"><a href="#section-2.1.6" class="auto internal xref">2.1.6</a>.  <a href="#name-certificates-formal-overvie" class="internal xref">Certificates - Formal Overview</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-certificate-specification-2" class="internal xref">Certificate Specification</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1"><a href="#section-2.2.1" class="auto internal xref">2.2.1</a>.  <a href="#name-basic-fields-scion-specific" class="internal xref">Basic Fields: SCION-Specific Constraints and Conditions</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.2">
                    <p id="section-toc.1-1.2.2.2.2.2.1"><a href="#section-2.2.2" class="auto internal xref">2.2.2</a>.  <a href="#name-extensions" class="internal xref">Extensions</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-trust-root-configuration-sp" class="internal xref">Trust Root Configuration Specification</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-trc-specification" class="internal xref">TRC Specification</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="auto internal xref">3.1.1</a>.  <a href="#name-trc-types-and-states" class="internal xref">TRC Types and States</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="auto internal xref">3.1.2</a>.  <a href="#name-trc-format" class="internal xref">TRC Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.3">
                    <p id="section-toc.1-1.3.2.1.2.3.1"><a href="#section-3.1.3" class="auto internal xref">3.1.3</a>.  <a href="#name-trc-signature-syntax" class="internal xref">TRC Signature Syntax</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.4">
                    <p id="section-toc.1-1.3.2.1.2.4.1"><a href="#section-3.1.4" class="auto internal xref">3.1.4</a>.  <a href="#name-certification-path-trust-an" class="internal xref">Certification Path - Trust Anchor Pool</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.5">
                    <p id="section-toc.1-1.3.2.1.2.5.1"><a href="#section-3.1.5" class="auto internal xref">3.1.5</a>.  <a href="#name-trc-updates" class="internal xref">TRC Updates</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-initial-trc-signing-ceremon" class="internal xref">Initial TRC Signing Ceremony</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-deploying-the-cp-pki-specif" class="internal xref">Deploying the CP PKI - Specifications</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-deploying-a-trc" class="internal xref">Deploying a TRC</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="auto internal xref">4.1.1</a>.  <a href="#name-base-trc" class="internal xref">Base TRC</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="auto internal xref">4.1.2</a>.  <a href="#name-trc-update" class="internal xref">TRC Update</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-signing-and-verifying-contr" class="internal xref">Signing and Verifying Control-Plane Messages</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-signing-a-control-plane-mes" class="internal xref">Signing a Control-Plane Message</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="auto internal xref">4.2.2</a>.  <a href="#name-verifying-a-control-plane-m" class="internal xref">Verifying a Control-Plane Message</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-creating-a-new-control-plan" class="internal xref">Creating a New Control-Plane AS Certificate</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-dependency-on-certificates" class="internal xref">Dependency on Certificates</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="auto internal xref">5.1.1</a>.  <a href="#name-compromise-of-an-isd" class="internal xref">Compromise of an ISD</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="auto internal xref">5.1.2</a>.  <a href="#name-recovery-from-compromise" class="internal xref">Recovery from Compromise</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-denial-of-service-attacks" class="internal xref">Denial of Service Attacks</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-appendix-a-signing-ceremony" class="internal xref">Appendix A. Signing Ceremony Initial TRC</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#appendix-B.1" class="auto internal xref"></a><a href="#name-ceremony-participants" class="internal xref">Ceremony Participants</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#appendix-B.2" class="auto internal xref"></a><a href="#name-ceremony-preparations" class="internal xref">Ceremony Preparations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.1">
                    <p id="section-toc.1-1.9.2.2.2.1.1"><a href="#appendix-B.2.1" class="auto internal xref"></a><a href="#name-location" class="internal xref">Location</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.2">
                    <p id="section-toc.1-1.9.2.2.2.2.1"><a href="#appendix-B.2.2" class="auto internal xref"></a><a href="#name-devices" class="internal xref">Devices</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.3">
                    <p id="section-toc.1-1.9.2.2.2.3.1"><a href="#appendix-B.2.3" class="auto internal xref"></a><a href="#name-preparation-steps" class="internal xref">Preparation Steps</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#appendix-B.3" class="auto internal xref"></a><a href="#name-ceremony-process" class="internal xref">Ceremony Process</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.1">
                    <p id="section-toc.1-1.9.2.3.2.1.1"><a href="#appendix-B.3.1" class="auto internal xref"></a><a href="#name-phase-1-certificate-exchang" class="internal xref">Phase 1: Certificate Exchange</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.2">
                    <p id="section-toc.1-1.9.2.3.2.2.1"><a href="#appendix-B.3.2" class="auto internal xref"></a><a href="#name-phase-2-generation-of-the-t" class="internal xref">Phase 2: Generation of the TRC Payload</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.3">
                    <p id="section-toc.1-1.9.2.3.2.3.1"><a href="#appendix-B.3.3" class="auto internal xref"></a><a href="#name-phase-3-trc-signing" class="internal xref">Phase 3: TRC Signing</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3.2.4">
                    <p id="section-toc.1-1.9.2.3.2.4.1"><a href="#appendix-B.3.4" class="auto internal xref"></a><a href="#name-phase-4-trc-validation" class="internal xref">Phase 4: TRC Validation</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-change-log" class="internal xref">Change Log</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#appendix-C.1" class="auto internal xref"></a><a href="#name-draft-dekater-scion-pki-07" class="internal xref">draft-dekater-scion-pki-07</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#appendix-C.2" class="auto internal xref"></a><a href="#name-draft-dekater-scion-pki-06" class="internal xref">draft-dekater-scion-pki-06</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">SCION is a path-aware internetworking routing architecture as described in <span>[<a href="#RFC9217" class="cite xref">RFC9217</a>]</span>. It allows endpoints and applications to select paths across the network to use for traffic, based on trustworthy path properties. SCION is an inter-domain network architecture and is therefore not concerned with intra-domain forwarding.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">SCION has been developed with the following goals:<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3"><em>Availability</em> - to provide highly available communication that can send traffic over paths with optimal or required characteristics, quickly handle inter-domain link or router failures (both on the last hop or anywhere along the path) and provide continuity in the presence of adversaries.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4"><em>Security</em> - to provide higher levels of trust in routing information in order to prevent IP prefix hijacking/leaks, denial-of-service and other attacks. Endpoints can decide the trust roots they wish to rely on, routing information can be unambiguously attributed to an AS, and packets are only forwarded along authorized path segments. A particular use case is to enable geofencing.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5"><em>Scalability</em> - to improve the scalability of the inter-domain control plane and data plane, avoiding existing limitations related to convergence and forwarding table size. The advertising of path segments is separated into a beaconing process within each Isolation Domain (ISD) and between ISDs which incurs minimal overhead and resource requirements on routers.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">SCION relies on three main components:<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7"><em>PKI</em> - To achieve scalability and trust, SCION organizes existing ASes into logical groups of independent routing planes called <em>Isolation Domains (ISDs)</em>. All ASes in an ISD agree on a set of trust roots called the <em>Trust Root Configuration (TRC)</em> which is a collection of signed root certificates in X.509 v3 format <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>. The ISD is governed by a set of <em>core ASes</em> which typically manage the trust roots and provide connectivity to other ISDs. This is the basis of the public key infrastructure which the SCION control plane relies upon for the authentication of messages that is used for the SCION control plane.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8"><em>Control Plane</em> - performs inter-domain routing by discovering and securely disseminating path information between ASes. The core ASes use Path-segment Construction Beacons (PCBs) to explore intra-ISD paths, or to explore paths across different ISDs. See <span>[<a href="#I-D.scion-cp" class="cite xref">I-D.scion-cp</a>]</span><a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9"><em>Data Plane</em> - carries out secure packet forwarding between SCION-enabled ASes over paths selected by endpoints. A SCION border router reuses existing intra-domain infrastructure to communicate to other SCION routers or SCION endpoints within its AS. See <span>[<a href="#I-D.scion-dataplane" class="cite xref">I-D.scion-dataplane</a>]</span><a href="#section-1-9" class="pilcrow">¶</a></p>
<p id="section-1-10">This document describes the SCION PKI component used by the Control Plane.<a href="#section-1-10" class="pilcrow">¶</a></p>
<p id="section-1-11">The SCION architecture was initially developed outside of the IETF by ETH Zurich with significant contributions from Anapaya Systems. The aim of this document is to describe existing implementations and operational deployments, and to introduce new concepts that can potentially address particular problems with the current Internet architecture.<a href="#section-1-11" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1"><strong>Control-Plane PKI (CP-PKI)</strong>: The control-plane PKI is the public-key infrastructure upon which SCION's control plane relies for the authentication of messages. It is a set of policies, roles, and procedures that are used to manage trust root configurations (TRCs) and certificates.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2"><strong>Autonomous System (AS)</strong>: An autonomous system is a network under a common administrative control. For example, the network of an Internet service provider, company, or university can constitute an AS. If an organization operates multiple networks that are not directly connected together, then the different networks are considered different ASes.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3"><strong>Isolation Domain (ISD)</strong>: In SCION, Autonomous Systems (ASes) are organized into logical groups called isolation domains or ISDs. Each ISD consists of ASes that span an area with a uniform trust environment (i.e., a common jurisdiction). A possible model is for ISDs to be formed along national boundaries or federations of nations.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<p id="section-1.1-4"><strong>Core AS</strong>: Each isolation domain (ISD) is administered by a set of distinguished autonomous systems (ASes) called core ASes, which are responsible for initiating the path-discovery and -construction process (in SCION called "beaconing").<a href="#section-1.1-4" class="pilcrow">¶</a></p>
<p id="section-1.1-5"><strong>Trust Root Configuration (TRC)</strong>: A trust root configuration or TRC is a signed collection of certificates pertaining to an isolation domain (ISD). TRCs also contain ISD-specific policies.<a href="#section-1.1-5" class="pilcrow">¶</a></p>
<p id="section-1.1-6"><strong>Authoritative AS</strong>: Authoritative ASes are those ASes in an ISD that always have the latest TRCs of the ISD. As a consequence, authoritative ASes also start the announcement of a TRC update.<a href="#section-1.1-6" class="pilcrow">¶</a></p>
<p id="section-1.1-7"><strong>Base TRC</strong>: A base TRC is a trust root configuration (TRC) that other parties trust axiomatically. In other words, trust for a base TRC is assumed, not derived from another cryptographic object. Each ISD <span class="bcp14">MUST</span> create and sign a base TRC when the ISD is established. A base TRC is either the first TRC of the ISD or the result of a trust reset.<a href="#section-1.1-7" class="pilcrow">¶</a></p>
<p id="section-1.1-8"><strong>TRC Signing Ceremony</strong>: The ceremony during which the very first base TRC of an ISD, called the initial TRC, is signed. The initial TRC is a special case of the base TRC where the number of the ISD is assigned.<a href="#section-1.1-8" class="pilcrow">¶</a></p>
<p id="section-1.1-9"><strong>TRC Update</strong>: A <em>regular</em> TRC update is a periodic re-issuance of the TRC where the entities and policies listed in the TRC remain unchanged. A <em>sensitive</em> TRC update is an update that modifies critical aspects of the TRC, such as the set of core ASes. In both cases, the base TRC remains unchanged.<a href="#section-1.1-9" class="pilcrow">¶</a></p>
<p id="section-1.1-10"><strong>Voting ASes</strong>: Those ASes within an ISD that may sign TRC updates. The process of appending a signature to a new TRC is called "casting a vote".<a href="#section-1.1-10" class="pilcrow">¶</a></p>
<p id="section-1.1-11"><strong>Voting Quorum</strong>: The voting quorum is a trust root configuration (TRC) field that indicates the number of votes (signatures) needed on a successor TRC for it to be verifiable. A voting quorum greater than one will thus prevent a single entity from creating a malicious TRC update.<a href="#section-1.1-11" class="pilcrow">¶</a></p>
<p id="section-1.1-12"><strong>Grace Period</strong>: The grace period is an interval during which the previous version of a trust root configuration (TRC) is still considered active after a new version has been published.<a href="#section-1.1-12" class="pilcrow">¶</a></p>
<p id="section-1.1-13"><strong>Trust Reset</strong>: A trust reset is the action of announcing a new base TRC for an existing ISD. A trust reset <span class="bcp14">SHOULD</span> only be triggered after a catastrophic event involving the loss or compromise of several important private keys.<a href="#section-1.1-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-1.2">
        <h3 id="name-conventions-and-definitions">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
        </h3>
<p id="section-1.2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trust-model">
<section id="section-1.3">
        <h3 id="name-trust-model">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-trust-model" class="section-name selfRef">Trust Model</a>
        </h3>
<p id="section-1.3-1">Given the diverse nature of the constituents in the current Internet, an important challenge is how to scale authentication of network elements (such as AS ownership, hop-by-hop routing information, name servers for DNS, and domains for TLS) to the global environment. The roots of trust of currently prevalent public key infrastructure (PKI) models do not scale well to a global environment, because (1) mutually distrustful parties cannot agree on a single trust root (monopoly model), and because (2) the security of a plethora of roots of trust is only as strong as its weakest link (oligopoly model) - see also <span>[<a href="#BARRERA17" class="cite xref">BARRERA17</a>]</span>.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3-2">The monopoly model suffers from two main drawbacks: First, all parties must agree on a single root of trust. Secondly, the single root of trust represents a single point of failure, the misuse of which enables the forging of certificates. Also, its revocation can result in a kill-switch for all the entities it certifies. The oligopoly model relies on several roots of trust, all equally and completely trusted. However, this is not automatically better: Whereas the monopoly model has a single point of failure, the oligopoly model has the drawback of exposing more than one point of failure.<a href="#section-1.3-2" class="pilcrow">¶</a></p>
<p id="section-1.3-3">Thus, there is a need for a trust architecture that supports meaningful trust roots in a global environment with inherently distrustful parties. This new trust architecture should provide the following properties:<a href="#section-1.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3-4.1">
            <p id="section-1.3-4.1.1">Trust agility (see further below);<a href="#section-1.3-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-4.2">
            <p id="section-1.3-4.2.1">Resilience to single root of trust compromise;<a href="#section-1.3-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-4.3">
            <p id="section-1.3-4.3.1">Multilateral governance; and<a href="#section-1.3-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-4.4">
            <p id="section-1.3-4.4.1">Support for policy versioning and updates.<a href="#section-1.3-4.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.3-5">Ideally, the trust architecture allows parties that mutually trust each other to form their own trust "union" or "domain", and to freely decide whether to trust other trust unions (domains) outside their own trust bubble.<a href="#section-1.3-5" class="pilcrow">¶</a></p>
<p id="section-1.3-6">To fulfill the above requirements, which in fact apply well to inter-domain networking, SCION introduces the concept of <strong>Isolation Domains</strong>. An Isolation Domain (ISD) is a building block for achieving high availability, scalability, and support for heterogeneous trust. It consists of a logical grouping of ASes that share a uniform trust environment (i.e., a common jurisdiction). An ISD is administered by one or multiple ASes, called the <strong>voting ASes</strong>. Furthermore, each ISD has a set of ASes that form the ISD core; these are the <strong>core ASes</strong>. The set of core and voting ASes can, but not necessarily have to, overlap. It is governed by a policy called the <strong>Trust Root Configuration</strong> (TRC), which is negotiated by the ISD core. The TRC defines the locally scoped roots of trust used to validate bindings between names and public keys.<a href="#section-1.3-6" class="pilcrow">¶</a></p>
<p id="section-1.3-7">Authentication in SCION is based on digital certificates that bind identifiers to public keys and carry digital signatures that are verified by roots of trust. SCION allows each ISD to define its own set of trust roots, along with the policy governing their use. Such scoping of trust roots within an ISD improves security, as compromise of a private key associated with a trust root cannot be used to forge a certificate outside the ISD. An ISD's trust roots and policy are encoded in the TRC, which has a version number, a list of public keys that serves as root of trust for various purposes, and policies governing the number of signatures required for performing different types of actions. The TRC serves as a way to bootstrap all authentication within SCION. Additionally, TRC versioning is used to efficiently revoke compromised roots of trust.<a href="#section-1.3-7" class="pilcrow">¶</a></p>
<p id="section-1.3-8">The TRC also provides <em>trust agility</em>, that is, it enables users to select the trust roots used to initiate certificate validation. This implies that users are free to choose an ISD they believe maintains a non-compromised set of trust roots. ISD members can also decide whether to trust other ISDs and thus transparently define trust relationships between parts of the network. The SCION trust model, therefore, differs from the one provided by other PKI architectures.<a href="#section-1.3-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trust-relations-within-an-isolation-domain">
<section id="section-1.4">
        <h3 id="name-trust-relations-within-an-i">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-trust-relations-within-an-i" class="section-name selfRef">Trust Relations within an Isolation Domain</a>
        </h3>
<p id="section-1.4-1">As already mentioned previously, the control-plane PKI, SCION's concept of trust, is organized on ISD-level. Each ISD can independently specify its own Trust Root Configuration (TRC) and build its own verification chain. Each TRC consists of a collection of signed root certificates, which are used to sign CA certificates, which are in turn used to sign AS certificates. The TRC also includes ISD-policies that specify, for example, the TRC's usage, validity, and future updates. A TRC is a fundamental component of an ISD's control-plane PKI. The so-called <strong>base TRC</strong> constitutes the ISD's trust anchor. It is signed during a signing ceremony by the voting ASes and then distributed throughout the ISD.<a href="#section-1.4-1" class="pilcrow">¶</a></p>
<div id="trust-reset">
<section id="section-1.4.1">
          <h4 id="name-updates-and-trust-resets">
<a href="#section-1.4.1" class="section-number selfRef">1.4.1. </a><a href="#name-updates-and-trust-resets" class="section-name selfRef">Updates and Trust Resets</a>
          </h4>
<p id="section-1.4.1-1">There are two types of TRC updates: regular and sensitive. A <strong>regular TRC update</strong> is a periodic re-issuance of the TRC where the entities and policies listed in the TRC remain unchanged, whereas a <strong>sensitive TRC update</strong> is an update that modifies critical aspects of the TRC, such as the set of core ASes. In both cases, the base TRC remains unchanged. If the ISD's TRC has been compromised, it is necessary for an ISD to re-establish the trust root. This is possible with a process called <strong>trust reset</strong> (if permitted by the ISD's trust policy). In this case, a new base TRC is created.<a href="#section-1.4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="substitutes-to-revocation">
<section id="section-1.4.2">
          <h4 id="name-substitutes-to-certificate-">
<a href="#section-1.4.2" class="section-number selfRef">1.4.2. </a><a href="#name-substitutes-to-certificate-" class="section-name selfRef">Substitutes to Certificate Revocation</a>
          </h4>
<p id="section-1.4.2-1">The CP-PKI does not explicitly support certificate revocation. Instead, it relies on the two mechanisms described above and on short-lived certificates. This approach constitutes an attractive alternative to a revocation system for the following reasons:<a href="#section-1.4.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.4.2-2.1">
              <p id="section-1.4.2-2.1.1">Both short-lived certificates and revocation lists must be signed by a CA. Instead of periodically signing a new revocation list, the CA can simply re-issue all the non-revoked certificates. Although the overhead of signing multiple certificates is greater than that of signing a single revocation list, the overall complexity of the system is reduced. In the CP-PKI the number of certificates that each CA must renew is manageable as it is limited to at most the number of ASes within an ISD.<a href="#section-1.4.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.4.2-2.2">
              <p id="section-1.4.2-2.2.1">Even with a revocation system, a compromised key cannot be instantaneously revoked. Through their validity period, both short-lived certificates and revocation lists implicitly define an attack window (i.e., a period during which an attacker who managed to compromise a key could use it before it becomes invalid). In both cases, the CA must consider a tradeoff between efficiency and security when picking this validity period.<a href="#section-1.4.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="overview-of-certificates-keys-and-roles">
<section id="section-1.5">
        <h3 id="name-overview-of-certificates-ke">
<a href="#section-1.5" class="section-number selfRef">1.5. </a><a href="#name-overview-of-certificates-ke" class="section-name selfRef">Overview of Certificates, Keys, and Roles</a>
        </h3>
<p id="section-1.5-1">The base TRC constitutes the root of trust within an ISD. <a href="#_figure-1" class="auto internal xref">Figure 1</a> provides a first impression of the trust chain within an ISD, based on its TRC. For detailed descriptions, please refer to <a href="#cert-specs" class="auto internal xref">Section 2</a> and <a href="#trc-specification" class="auto internal xref">Section 3</a>.<a href="#section-1.5-1" class="pilcrow">¶</a></p>
<span id="name-chain-of-trust-within-an-is"></span><div id="_figure-1">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-1.5-2.1">
<pre>
                                    TRC 2

               +--------------------------------------+
               |+------------------------------------+|
               ||- Version       - Core ASes         ||
+--------+     ||- ID            - Description       ||    +--------+
| TRC 1  |     ||- Validity      - No Trust Reset    ||    | TRC 3  |
| (Base  |----&gt;||- Grace Period  - Voting Quorum     ||---&gt;|        |
|  TRC)  |     ||- ...                               ||    |        |
+--------+     |+------------------------------------+|    +--------+
               |+----------------+  +----------------+|
               || Regular Voting |  |Sensitive Voting||
               ||  Certificate   |  |  Certificate   ||
               |+----------------+  +----------------+|
               |+----------------+  +----------------+|
               ||     Votes      |  |   Signatures   ||
               |+----------------+  +----------------+|
               |+------------------------------------+|
               ||        CP Root Certificates        ||
               |+----------+-------------+-----------+|
               |           |             |            |
               +-----------+-------------+------------+
                           |             |
                           |             |
                           v             v
                 +-----------+         +-----------+
                 |   CP CA   |         |   CP CA   |
                 |Certificate|         |Certificate|
                 +-+-------+-+         +-----+-----+
                   |       |                 |
                   |       |                 |
                   v       v                 v
          +-----------+ +-----------+      +-----------+
          |   CP AS   | |   CP AS   |      |   CP AS   |
          |Certificate| |Certificate|      |Certificate|
          +-----------+ +-----------+      +-----------+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-chain-of-trust-within-an-is" class="selfRef">Chain of trust within an ISD</a>
          </figcaption></figure>
</div>
<p id="section-1.5-3">All certificates used in SCION's control-plane PKI are in X.509 v3 format <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>. Additionally, the TRC contains self-signed certificates instead of plain public keys. Self-signed certificates have the following advantages over plain public keys: (1) They make the binding between name and public key explicit; and (2) the binding is signed to prove possession of the corresponding private key.<a href="#section-1.5-3" class="pilcrow">¶</a></p>
<p id="section-1.5-4">All ASes in SCION have the task to sign and verify control-plane messages. However, certain ASes have additional roles:<a href="#section-1.5-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.5-5.1">
            <p id="section-1.5-5.1.1"><strong>Core ASes</strong>: Core ASes are a distinct set of ASes in the SCION control plane. For each ISD, the core ASes are listed in the TRC. Each core AS in an ISD has links to other core ASes (in the same or in different ISDs).<a href="#section-1.5-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.5-5.2">
            <p id="section-1.5-5.2.1"><strong>Certification authorities (CAs)</strong>: CAs are responsible for issuing AS certificates to other ASes and/or themselves.<a href="#section-1.5-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.5-5.3">
            <p id="section-1.5-5.3.1"><strong>Voting ASes</strong>: Only certain ASes within an ISD may sign TRC updates. The process of appending a signature to a new TRC is called "casting a vote"; the designated ASes that hold the private keys to sign a TRC update are "voting ASes".<a href="#section-1.5-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.5-5.4">
            <p id="section-1.5-5.4.1"><strong>Authoritative ASes</strong>: Authoritative ASes are those ASes in an ISD that always have the latest TRCs of the ISD. They start the announcement of a TRC update.<a href="#section-1.5-5.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-1.5-6">All further details of the SCION control-plane PKI are specified in the following sections.<a href="#section-1.5-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trust-as-a-function">
<section id="section-1.6">
        <h3 id="name-trust-as-a-function">
<a href="#section-1.6" class="section-number selfRef">1.6. </a><a href="#name-trust-as-a-function" class="section-name selfRef">Trust as a Function</a>
        </h3>
<p id="section-1.6-1">The SCION control-plane PKI can be seen as a function that transforms potential distrust among different parties into a mutually accepted trust contract including a trust update and reset policy as well as certificates used for authentication procedures in SCION's control plane.<a href="#section-1.6-1" class="pilcrow">¶</a></p>
<p id="section-1.6-2">For the function to work, it is not necessary that the ASes of the ISD all trust each other. However, all ASes <span class="bcp14">MUST</span> trust the ISD's core ASes, authoritative ASes, voting ASes, as well as its CA(s). These trusted parties negotiate the ISD trust contract in a "bootstrapping of trust" ceremony, where cryptographic material is exchanged, and the ISD's trust anchor (the initial Trust Root Configuration) is created and signed.<a href="#section-1.6-2" class="pilcrow">¶</a></p>
<div id="input">
<section id="section-1.6.1">
          <h4 id="name-input">
<a href="#section-1.6.1" class="section-number selfRef">1.6.1. </a><a href="#name-input" class="section-name selfRef">Input</a>
          </h4>
<p id="section-1.6.1-1">Prior to the ceremony, the trusted parties <span class="bcp14">MUST</span> decide about the validity period of the TRC as well as the number of votes required to update a TRC. They <span class="bcp14">MUST</span> also bring the required keys and certificates, the so-called root and voting keys/certificates.<a href="#section-1.6.1-1" class="pilcrow">¶</a></p>
<p id="section-1.6.1-2">During the ceremony, the trusted parties decide about the number of the ISD. This <span class="bcp14">MUST</span> be an integer in the inclusive range between 64 and 4094. The next table shows the current allocation of ISD numbers in SCION:<a href="#section-1.6.1-2" class="pilcrow">¶</a></p>
<span id="name-isd-number-allocations"></span><div id="_table-1">
<table class="center" id="table-1">
            <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-isd-number-allocations" class="selfRef">ISD Number Allocations</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">ISD</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">0</td>
                <td class="text-left" rowspan="1" colspan="1">The wildcard ISD.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">1 - 15</td>
                <td class="text-left" rowspan="1" colspan="1">Reserved for documentation and sample code (analogous to <span>[<a href="#RFC5398" class="cite xref">RFC5398</a>]</span>.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">16 - 63</td>
                <td class="text-left" rowspan="1" colspan="1">Private use (analogous to <span>[<a href="#RFC6996" class="cite xref">RFC6996</a>]</span>). Can be used for testing and private deployments.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">64 - 4094</td>
                <td class="text-left" rowspan="1" colspan="1">Public ISDs. Should be allocated in ascending order, without gaps and "vanity" numbers.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">4095 - 65535</td>
                <td class="text-left" rowspan="1" colspan="1">Reserved for future use.</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<div id="output">
<section id="section-1.6.2">
          <h4 id="name-output">
<a href="#section-1.6.2" class="section-number selfRef">1.6.2. </a><a href="#name-output" class="section-name selfRef">Output</a>
          </h4>
<p id="section-1.6.2-1">The output of the bootstrapping of trust ceremony, or the trust "function", are the ISD's initial Trust Root Configuration as well as mutually trusted and accepted CA and AS certificates--the latter are used to verify SCION's control-plane messages. Together with the ISD's control-plane root certificates, the CA and AS certificates build the ISD's trust and verification chain.<a href="#section-1.6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="cert-specs">
<section id="section-2">
      <h2 id="name-certificate-specification">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-certificate-specification" class="section-name selfRef">Certificate Specification</a>
      </h2>
<p id="section-2-1">This section provides a detailed specification of all certificates used in SCION's control-plane PKI. It starts with an overview of the main keys and certificates.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="overview">
<section id="section-2.1">
        <h3 id="name-scion-control-plane-pki-key">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-scion-control-plane-pki-key" class="section-name selfRef">SCION Control-Plane PKI Keys and Certificates - Overview</a>
        </h3>
<p id="section-2.1-1">There are three types of control-plane (CP) certificates: root certificates, CA certificates, and AS certificates. Together, they build a chain of trust that is anchored in the trust root configuration (TRC) file of the respective Isolation Domain (ISD). Additionally, there are regular and sensitive voting certificates, which define the keys to cast votes in a regular and a sensitive TRC update, respectively.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">All certificates in SCION's control-plane PKI are in X.509 v3 format <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">The next section shows SCION's trust hierarchy. This is followed by sections that describe the main certificates and corresponding key pairs of SCION's control-plane PKI as well as the voting certificates and keys.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<div id="trust-hierarchy">
<section id="section-2.1.1">
          <h4 id="name-trust-hierarchy">
<a href="#section-2.1.1" class="section-number selfRef">2.1.1. </a><a href="#name-trust-hierarchy" class="section-name selfRef">Trust Hierarchy</a>
          </h4>
<p id="section-2.1.1-1">The trust is anchored in the Trust Root Configuration (TRC) for each ISD. The trust root is axiomatic: All trust derived from this anchor relies on all parties transitively trusting the TRC.<a href="#section-2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1.1-2">The trust hierarchy looks like this:<a href="#section-2.1.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1.1-3">
<pre>
TRC
── Regular Voting Certificates
     └── TRC (next version, regular update)
── Sensitive Voting Certificates
     └── TRC (next version, sensitive update)
── CP Root Certificates
     └── CP CA Certificates
          └── CP AS Certificates
</pre><a href="#section-2.1.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="cp-root-cert">
<section id="section-2.1.2">
          <h4 id="name-control-plane-root-certific">
<a href="#section-2.1.2" class="section-number selfRef">2.1.2. </a><a href="#name-control-plane-root-certific" class="section-name selfRef">Control-Plane Root Certificate</a>
          </h4>
<p id="section-2.1.2-1">The control-plane root private key is used to sign control-plane CA certificates. Consequently, the control-plane root certificate with the control-plane root public key is used to verify control-plane CA certificates, i.e., root certificates determine which ASes act as CA in an ISD.<a href="#section-2.1.2-1" class="pilcrow">¶</a></p>
<p id="section-2.1.2-2">In X.509 terms, CP root certificates are <em>self-signed</em> CA certificates. That is, issuer and subject of the certificate are the same entity, and the public key in the root certificate can be used to verify the root certificate's signature. The CP root public key and proof of ownership of the private key are embedded in the Trust Root Configuration (TRC) of an Isolation Domain (ISD), via the self-signed CP root certificate. This facilitates the bootstrapping of trust within an ISD, and marks the CP root certificates as the starting point of an ISD's certificate verification path.<a href="#section-2.1.2-2" class="pilcrow">¶</a></p>
<p id="section-2.1.2-3">The <span class="bcp14">RECOMMENDED</span> <strong>maximum validity period</strong> of a CP root certificate is: 1 year.<a href="#section-2.1.2-3" class="pilcrow">¶</a></p>
<p id="section-2.1.2-4"><strong>Note</strong>: The TRC of each ISD contains a trusted set of control-plane root certificates. This set builds the root of each ISD's verification path. For more information on the selection of this trusted set of root certificates, see <a href="#trc-specification" class="auto internal xref">Section 3</a>.<a href="#section-2.1.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="control-plane-ca-certificate">
<section id="section-2.1.3">
          <h4 id="name-control-plane-ca-certificat">
<a href="#section-2.1.3" class="section-number selfRef">2.1.3. </a><a href="#name-control-plane-ca-certificat" class="section-name selfRef">Control-Plane CA Certificate</a>
          </h4>
<p id="section-2.1.3-1">The control-plane CA private key is used to sign control-plane AS certificates. Consequently, control-plane CA certificates holding the control-plane CA public key are used to verify control-plane AS certificates.<a href="#section-2.1.3-1" class="pilcrow">¶</a></p>
<p id="section-2.1.3-2">The public key needed to verify the CA certificate is in a CP root certificate. CA certificates do not bundle the root certificate needed to verify them. In order to verify a CA certificate, a pool of root certificates must first be extracted from one or more active TRCs (as described in <a href="#signing-verifying-cp-messages" class="auto internal xref">Section 4.2</a>).<a href="#section-2.1.3-2" class="pilcrow">¶</a></p>
<p id="section-2.1.3-3">The <span class="bcp14">RECOMMENDED</span> <strong>maximum validity period</strong> of a CP CA certificate is: 11 days.<a href="#section-2.1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="control-plane-as-certificate">
<section id="section-2.1.4">
          <h4 id="name-control-plane-as-certificat">
<a href="#section-2.1.4" class="section-number selfRef">2.1.4. </a><a href="#name-control-plane-as-certificat" class="section-name selfRef">Control-Plane AS Certificate</a>
          </h4>
<p id="section-2.1.4-1">SCION ASes sign control-plane messages, such as Path Construction Beacons, with their AS private key. Consequently, control-plane AS certificates holding the corresponding AS public key are required to verify control-plane messages.<a href="#section-2.1.4-1" class="pilcrow">¶</a></p>
<p id="section-2.1.4-2">In X.509 terms, control-plane AS certificates are end-entity certificates. That is, they cannot be used to verify other certificates.<a href="#section-2.1.4-2" class="pilcrow">¶</a></p>
<p id="section-2.1.4-3">The <span class="bcp14">RECOMMENDED</span> <strong>maximum validity period</strong> of a CP AS certificate is: 3 days.<a href="#section-2.1.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cp-voting-cert">
<section id="section-2.1.5">
          <h4 id="name-voting-certificates">
<a href="#section-2.1.5" class="section-number selfRef">2.1.5. </a><a href="#name-voting-certificates" class="section-name selfRef">Voting Certificates</a>
          </h4>
<p id="section-2.1.5-1">There are two types of voting certificates: the (1) regular voting certificates and the (2) sensitive voting certificates. They contain the public keys associated with the private keys that <span class="bcp14">MAY</span> cast votes in the TRC update process. Voting certificates are X.509-style certificates.<a href="#section-2.1.5-1" class="pilcrow">¶</a></p>
<p id="section-2.1.5-2">Regular and sensitive voting certificates are used to verify regular and sensitive TRC updates, respectively, and are embedded in the TRC.<a href="#section-2.1.5-2" class="pilcrow">¶</a></p>
<div id="regular-voting-certificate">
<section id="section-2.1.5.1">
            <h5 id="name-regular-voting-certificate">
<a href="#section-2.1.5.1" class="section-number selfRef">2.1.5.1. </a><a href="#name-regular-voting-certificate" class="section-name selfRef">Regular Voting Certificate</a>
            </h5>
<p id="section-2.1.5.1-1">Regular voting certificates state which keys <span class="bcp14">MAY</span> cast votes in a regular update. In X.509 terms, regular voting certificates are self-signed end-entity certificates. This means that the issuer and subject of a regular voting certificate are the same entity, and the public key within the certificate can be used to verify the certificate's signature. However, a regular voting certificate cannot be used to verify other certificates.<a href="#section-2.1.5.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1.5.1-2">The <span class="bcp14">RECOMMENDED</span> <strong>maximum validity period</strong> of a regular voting certificate is: 1 year.<a href="#section-2.1.5.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sensitive-voting-certificate">
<section id="section-2.1.5.2">
            <h5 id="name-sensitive-voting-certificat">
<a href="#section-2.1.5.2" class="section-number selfRef">2.1.5.2. </a><a href="#name-sensitive-voting-certificat" class="section-name selfRef">Sensitive Voting Certificate</a>
            </h5>
<p id="section-2.1.5.2-1">Sensitive voting certificates specify which keys <span class="bcp14">MAY</span> cast votes in a sensitive update. In X.509 terms, sensitive voting certificates are self-signed end-entity certificates. This means that the issuer and subject of a sensitive voting certificate are the same entity, and the public key within the certificate can be used to verify the certificate's signature. However, a sensitive voting certificate cannot be used to verify other certificates.<a href="#section-2.1.5.2-1" class="pilcrow">¶</a></p>
<p id="section-2.1.5.2-2">The <span class="bcp14">RECOMMENDED</span> <strong>maximum validity period</strong> of a sensitive voting certificate is: 5 years.<a href="#section-2.1.5.2-2" class="pilcrow">¶</a></p>
<p id="section-2.1.5.2-3"><strong>Note</strong>:<a href="#section-2.1.5.2-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1.5.2-4.1">
                <p id="section-2.1.5.2-4.1.1">Both SCION's control-plane root certificates and control-plane CA certificates are in fact CA certificates. That is, they can both be used to verify other certificates.<a href="#section-2.1.5.2-4.1.1" class="pilcrow">¶</a></p>
<p id="section-2.1.5.2-4.1.2">One important difference between both certificate types lies in their validity period: A SCION control-plane root certificate has a <span class="bcp14">RECOMMENDED</span> maximum validity period of one year, whereas the <span class="bcp14">RECOMMENDED</span> maximum validity period of a SCION control-plane CA certificate is 11 days. This is because a root certificate is part of the Trust Root Configuration of an ISD, which itself also has a <span class="bcp14">RECOMMENDED</span> maximum validity period of one year (see Table 2 below). This ensures that the TRC need not be updated all the time and is thus relatively stable.<a href="#section-2.1.5.2-4.1.2" class="pilcrow">¶</a></p>
<p id="section-2.1.5.2-4.1.3">The SCION root private key and public key/certificate are used to sign and verify the control-plane CA certificates, respectively. The control-plane CA certificates are explicitly NOT part of the TRC, for reasons of security. The control-plane CA certificates are used to verify the control-plane AS certificates, which in turn are used to verify control-plane messages. Routing is made more secure if both the SCION control-plane CA and AS certificates can be renewed on a very regular basis. Would the control-plane CA and AS certificates be part of the TRC, then the TRC would have to be updated constantly, which is undesirable.<a href="#section-2.1.5.2-4.1.3" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
</section>
</div>
<div id="formal">
<section id="section-2.1.6">
          <h4 id="name-certificates-formal-overvie">
<a href="#section-2.1.6" class="section-number selfRef">2.1.6. </a><a href="#name-certificates-formal-overvie" class="section-name selfRef">Certificates - Formal Overview</a>
          </h4>
<p id="section-2.1.6-1"><a href="#_table-2" class="auto internal xref">Table 2</a> and <a href="#_table-3" class="auto internal xref">Table 3</a> below provide a formal overview of the different types of key pairs and certificates in the control-plane PKI.<a href="#section-2.1.6-1" class="pilcrow">¶</a></p>
<span id="name-key-chain"></span><div id="_table-2">
<table class="center" id="table-2">
            <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-key-chain" class="selfRef">Key chain</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Notation (1)</th>
                <th class="text-left" rowspan="1" colspan="1">Used to verify/sign</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Sensitive voting key</td>
                <td class="text-left" rowspan="1" colspan="1">K<sub>sens</sub>
</td>
                <td class="text-left" rowspan="1" colspan="1">TRC updates (sensitive)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Regular voting key</td>
                <td class="text-left" rowspan="1" colspan="1">K<sub>reg</sub>
</td>
                <td class="text-left" rowspan="1" colspan="1">TRC updates (regular)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">CP root key</td>
                <td class="text-left" rowspan="1" colspan="1">K<sub>root</sub>
</td>
                <td class="text-left" rowspan="1" colspan="1">CP CA certificates</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">CP CA key</td>
                <td class="text-left" rowspan="1" colspan="1">K<sub>CA</sub>
</td>
                <td class="text-left" rowspan="1" colspan="1">CP AS certificates</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">CP AS key</td>
                <td class="text-left" rowspan="1" colspan="1">K<sub>AS</sub>
</td>
                <td class="text-left" rowspan="1" colspan="1">CP messages, path segments</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-2.1.6-3">(1)  K<sub>x</sub> = PK<sub>x</sub> + SK<sub>x</sub>, where x = certificate type, PK<sub>x</sub> = public key, and SK<sub>x</sub> = private key<a href="#section-2.1.6-3" class="pilcrow">¶</a></p>
<span id="name-certificates"></span><div id="_table-3">
<table class="center" id="table-3">
            <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-certificates" class="selfRef">Certificates</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Name</th>
                <th class="text-left" rowspan="1" colspan="1">Notation</th>
                <th class="text-left" rowspan="1" colspan="1">Signed with</th>
                <th class="text-left" rowspan="1" colspan="1">Contains</th>
                <th class="text-left" rowspan="1" colspan="1">Validity (2)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">TRC (trust root conf.)</td>
                <td class="text-left" rowspan="1" colspan="1">TRC</td>
                <td class="text-left" rowspan="1" colspan="1">SK<sub>sens</sub>, SK<sub>reg</sub> (1)</td>
                <td class="text-left" rowspan="1" colspan="1">C<sub>root</sub>, C<sub>sens</sub>, C<sub>reg</sub> (1)</td>
                <td class="text-left" rowspan="1" colspan="1">1 year</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Sensitive voting cert.</td>
                <td class="text-left" rowspan="1" colspan="1">C<sub>sens</sub>
</td>
                <td class="text-left" rowspan="1" colspan="1">SK<sub>sens</sub>
</td>
                <td class="text-left" rowspan="1" colspan="1">PK<sub>sens</sub>
</td>
                <td class="text-left" rowspan="1" colspan="1">5 years</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Regular voting cert.</td>
                <td class="text-left" rowspan="1" colspan="1">C<sub>reg</sub>
</td>
                <td class="text-left" rowspan="1" colspan="1">SK<sub>reg</sub>
</td>
                <td class="text-left" rowspan="1" colspan="1">PK<sub>reg</sub>
</td>
                <td class="text-left" rowspan="1" colspan="1">1 year</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">CP root certificate</td>
                <td class="text-left" rowspan="1" colspan="1">C<sub>root</sub>
</td>
                <td class="text-left" rowspan="1" colspan="1">SK<sub>root</sub>
</td>
                <td class="text-left" rowspan="1" colspan="1">PK<sub>root</sub>
</td>
                <td class="text-left" rowspan="1" colspan="1">1 year</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">CP CA certificate</td>
                <td class="text-left" rowspan="1" colspan="1">C<sub>CA</sub>
</td>
                <td class="text-left" rowspan="1" colspan="1">SK<sub>root</sub>
</td>
                <td class="text-left" rowspan="1" colspan="1">PK<sub>CA</sub>
</td>
                <td class="text-left" rowspan="1" colspan="1">11 days (3)</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">CP AS certificate</td>
                <td class="text-left" rowspan="1" colspan="1">C<sub>AS</sub>
</td>
                <td class="text-left" rowspan="1" colspan="1">SK<sub>CA</sub>
</td>
                <td class="text-left" rowspan="1" colspan="1">PK<sub>AS</sub>
</td>
                <td class="text-left" rowspan="1" colspan="1">3 days</td>
              </tr>
            </tbody>
          </table>
</div>
<p id="section-2.1.6-5">(1) Multiple signatures and certificates of each type <span class="bcp14">MAY</span> be included in a TRC.<br>
(2) Recommended maximum validity period.<br>
(3) A validity of 11 days with 4 days overlap between two CA certificates is <span class="bcp14">RECOMMENDED</span> to enable the best possible operational procedures when performing a CA certificate rollover.<a href="#section-2.1.6-5" class="pilcrow">¶</a></p>
<p id="section-2.1.6-6"><a href="#_figure-2" class="auto internal xref">Figure 2</a> illustrates, at a high level, the relationship between a TRC and the five types of certificates.<a href="#section-2.1.6-6" class="pilcrow">¶</a></p>
<span id="name-trc-update-chain-and-the-di"></span><div id="_figure-2">
<figure id="figure-2">
            <div class="alignLeft art-text artwork" id="section-2.1.6-7.1">
<pre>
   +--------------------+     +--------------------+          +--------------+     +---------------+
   |       TRC 1        +----&gt;|       TRC 2       -+------&gt;╳  |       TRC 3  +----&gt;|       TRC 4   |
   |  (base, initial)   |     |  (regular update)  |          | (base, trust |     | (sensitive    |
+--+--------------------+     +--------------------+------+   |     reset)   |     |     update)   |
|                                                         |   +--------------+     +---------------+
|                                                         |
+--------------------------------------------+        +---+----------------------------------------+
|             TRC 1 (base, initial)          |        |             TRC 2 (regular update)         |
|+------------------------------------------+|        |+------------------------------------------+|
||- Version       - Core ASes               ||        ||- Version       - Core ASes               ||
||- ID            - Description             ||        ||- ID            - Description             ||
||- Validity      - No Trust Reset          ||        ||- Validity      - No Trust Reset          ||
||- Grace Period  - Voting Quorum           ||        ||- Grace Period  - Voting Quorum           ||
||- ...                                     ||        ||- ...                                     ||
|+------------------------------------------+|        |+------------------------------------------+|
|+--------------------++--------------------+|        |+--------------------++--------------------+|
||Votes (cert.indices)||   Regular Voting   ||        ||Votes (cert.indices)||   Regular Voting   ||
||                    ||    Certificates    ||        ||                    ||    Certificates    ||
||    (empty)         ||                    ||        ||    (1),(2)...      ||                    ||
||                    ||+-----+ +-----+     ||        ||                    ||+-----+ +-----+     ||
||                    ||| (1) | | (2) |     ||        ||                    ||| (1) | | (2) |     ||
||                    |||C    | |C    | ... ||        ||                    |||C    | |C    | ... ||
||                    ||| reg | | reg |     ||        ||                    ||| reg | | reg |     ||
|+--------------------+|+--+--+ +--+--+     ||        |+--------------------+|+-----+ +-----+     ||
|+--------------------+|   |       |        ||        |+--------------------+|                    ||
||                    ||   |       +--------++-----+  ||                    ||                    ||
||                    ||   +----------------++-+   |  ||                    ||                    ||
||    Signatures      |+--------------------+| |   |  ||    Signatures      |+--------------------+|
||                    |+--------------------+| |   |  ||                    |+--------------------+|
||+------------------+|| Sensitive Voting   || |   |  ||+------------------+|| Sensitive Voting   ||
|||73 A9 4E AO 0D ...|||    Certificates    || |   +--+&gt;|48 AE E4 80 DB ...|||    Certificates    ||
||+------------------+||+-----+ +-----+     || |      ||+------------------+||+-----+ +-----+     ||
||+------------------+||| (3) | | (4) |     || |      ||+------------------+||| (3) | | (4) |     ||
|||53 B7 7C 98 56 ...||||C    | |C    |     || +------+&gt;|7E BC 75 98 25 ...||||C    | |C    |     ||
||+------------------+||| sens| | sens| ... ||        ||+------------------+||| sens| | sens| ... ||
||        ...         ||+-----+ +-----+     ||        ||        ...         ||+-----+ +-----+     ||
|+--------------------++--------------------+|        |+--------------------++--------------------+|
|+------------------------------------------+|        |+------------------------------------------+|
||          CP Root Certificates            ||        ||          CP Root Certificates            ||
||                                          ||        ||                                          ||
|| +-----+ +-----+ +-----+ +-----+          ||        || +-----+ +-----+ +-----+ +-----+          ||
|| | (5) | | (6) | | (7) | | (8) |          ||        || | (5) | | (6) | | (7) | | (8) |          ||
|| |C    | |C    | |C    | |C    |          ||        || |C    | |C    | |C    | |C    |          ||
|| | root| | root| | root| | root| .....    ||        || | root| | root| | root| | root| .....    ||
|| +-----+ +--+--+ +-----+ +--+--+          ||        || +-----+ +--+--+ +-----+ +--+--+          ||
|+------------+---------------+-------------+|        |+------------+---------------+-------------+|
+-------------+---------------+--------------+        +-------------+---------------+--------------+
              |               |                                     |               |
    +---------v-+           +-v---------+                 +---------v-+           +-v---------+
    |   CP CA   |           |   CP CA   |                 |   CP CA   |           |   CP CA   |
    |Certificate|           |Certificate|                 |Certificate|           |Certificate|
    +-----+-----+           +-----+-----+                 +-+-------+-+           +-----+-----+
          |                       |                         |       |                   |
          |                       |                         |       |                   |
          v                       v                         v       v                   v
    +-----------+           +-----------+          +-----------+ +-----------+        +-----------+
    |   CP AS   |           |   CP AS   |          |   CP AS   | |   CP AS   |        |   CP AS   |
    |Certificate|           |Certificate|          |Certificate| |Certificate|        |Certificate|
    +-----------+           +-----------+          +-----------+ +-----------+        +-----------+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-trc-update-chain-and-the-di" class="selfRef">TRC update chain and the different types of associated certificates. Arrows show how signatures are verified; in other words, they indicate that a public key contained in a certificate or TRC can be used to verify the authenticity of another item.</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="certificate-specification">
<section id="section-2.2">
        <h3 id="name-certificate-specification-2">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-certificate-specification-2" class="section-name selfRef">Certificate Specification</a>
        </h3>
<p id="section-2.2-1">All certificates used in the SCION control-plane PKI are X.509 v3 certificates. However, the SCION specification is in some places more restrictive. This section defines these additional constraints and conditions compared to <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span> for each type of SCION control-plane PKI certificate.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<div id="basic-fields-scion-specific-constraints-and-conditions">
<section id="section-2.2.1">
          <h4 id="name-basic-fields-scion-specific">
<a href="#section-2.2.1" class="section-number selfRef">2.2.1. </a><a href="#name-basic-fields-scion-specific" class="section-name selfRef">Basic Fields: SCION-Specific Constraints and Conditions</a>
          </h4>
<p id="section-2.2.1-1">This section briefly describes the fields of the SCION control-plane PKI certificates based on X.509. These fields are relevant for each SCION certificate used in the control plane, regardless of the certificate type. For detailed descriptions of the full generic format of X.509 v3 certificates, see <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span> and <a href="https://handle.itu.int/11.1002/1000/13031">X509</a>, clause 7.2. Additionally, the section lists the SCION-specific constraints and conditions compared to <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>, per certificate field.<a href="#section-2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.2.1-2"><code>TBSCertificate</code> sequence: Contains information associated with the subject of the certificate and the CA that issued it. It includes the following fields:<a href="#section-2.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1-3.1">
              <p id="section-2.2.1-3.1.1"><code>version</code> field: Describes the version of the encoded certificate. It <span class="bcp14">MUST</span> be set to "v3" (as extensions are <span class="bcp14">REQUIRED</span> in SCION).<a href="#section-2.2.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.1-3.2">
              <p id="section-2.2.1-3.2.1"><code>serialNumber</code> field: A positive integer assigned by the CA to each certificate. It <span class="bcp14">MUST</span> be unique for each certificate issued by a given CA.<a href="#section-2.2.1-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.1-3.3">
              <p id="section-2.2.1-3.3.1"><code>signature</code> field: Contains the identifier for the algorithm used by the CA to sign the certificate.<a href="#section-2.2.1-3.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1-3.3.2.1">
                  <p id="section-2.2.1-3.3.2.1.1"><strong>SCION constraints</strong>: Currently, SCION only supports the ECDSA signature algorithm. Find all details here: <a href="#certsign" class="auto internal xref">Section 2.2.1.1</a>.<a href="#section-2.2.1-3.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-2.2.1-3.3.2.2">
                  <p id="section-2.2.1-3.3.2.2.1"><strong>Additional conditions and remarks</strong>: As a consequence, the <code>parameters</code> field in the <code>AlgorithmIdentifier</code> sequence <span class="bcp14">MUST NOT</span> be used.<a href="#section-2.2.1-3.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-2.2.1-3.4">
              <p id="section-2.2.1-3.4.1"><code>issuer</code> field: Contains the distinguished name (DN) of the entity that has issued and signed the certificate (usually a CA).<a href="#section-2.2.1-3.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1-3.4.2.1">
                  <p id="section-2.2.1-3.4.2.1.1"><strong>SCION constraints</strong>:<a href="#section-2.2.1-3.4.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1-3.4.2.1.2.1">
                      <p id="section-2.2.1-3.4.2.1.2.1.1">This field <span class="bcp14">MUST</span> be non-empty.<a href="#section-2.2.1-3.4.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-2.2.1-3.4.2.1.2.2">
                      <p id="section-2.2.1-3.4.2.1.2.2.1">SCION implementations <span class="bcp14">MUST</span> ONLY use the “UTF8String” value type for all attributes (including the SCION-specific attribute <code>ISD-AS number</code>).<a href="#section-2.2.1-3.4.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
                <li class="normal" id="section-2.2.1-3.4.2.2">
                  <p id="section-2.2.1-3.4.2.2.1"><strong>Additional conditions and remarks</strong>: All SCION implementations <span class="bcp14">MUST</span> support the additional SCION-specific attribute <code>ISD-AS number</code>. For details, see <a href="#issuer" class="auto internal xref">Section 2.2.1.2</a> and <a href="#isd-as-nr" class="auto internal xref">Section 2.2.1.2.1</a>.<a href="#section-2.2.1-3.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-2.2.1-3.5">
              <p id="section-2.2.1-3.5.1"><code>validity</code> field: Defines the validity period of the certificate.<a href="#section-2.2.1-3.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1-3.5.2.1">
                  <p id="section-2.2.1-3.5.2.1.1"><strong>SCION constraints</strong>: All certificates used in SCION's control-plane PKI <span class="bcp14">MUST</span> have a well-defined expiration date. Certificates with a generalized time value are not valid and <span class="bcp14">MUST</span> be rejected.<a href="#section-2.2.1-3.5.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-2.2.1-3.5.2.2">
                  <p id="section-2.2.1-3.5.2.2.1"><strong>Additional conditions and remarks</strong>: SCION recommends a specific maximum validity period for each type of control-plane PKI certificate. For details, see <a href="#formal" class="auto internal xref">Section 2.1.6</a>. SCION implementations <span class="bcp14">SHOULD</span> adopt these values.<a href="#section-2.2.1-3.5.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-2.2.1-3.6">
              <p id="section-2.2.1-3.6.1"><code>subject</code> field: Defines the entity that owns the certificate.<a href="#section-2.2.1-3.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1-3.6.2.1">
                  <p id="section-2.2.1-3.6.2.1.1"><strong>SCION constraints</strong>:<a href="#section-2.2.1-3.6.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1-3.6.2.1.2.1">
                      <p id="section-2.2.1-3.6.2.1.2.1.1">This field <span class="bcp14">MUST</span> be non-empty.<a href="#section-2.2.1-3.6.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-2.2.1-3.6.2.1.2.2">
                      <p id="section-2.2.1-3.6.2.1.2.2.1">SCION implementations <span class="bcp14">MUST</span> ONLY use the “UTF8String” value type for all attributes (including the SCION-specific attribute <code>ISD-AS number</code>).<a href="#section-2.2.1-3.6.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
                <li class="normal" id="section-2.2.1-3.6.2.2">
                  <p id="section-2.2.1-3.6.2.2.1"><strong>Additional conditions and remarks</strong>: The <code>subject</code> field is specified in the same way as the <code>issuer</code> field. For details, see <a href="#issuer" class="auto internal xref">Section 2.2.1.2</a> and <a href="#isd-as-nr" class="auto internal xref">Section 2.2.1.2.1</a>.<a href="#section-2.2.1-3.6.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-2.2.1-3.7">
              <p id="section-2.2.1-3.7.1"><code>subjectPublicKeyInfo</code> field: Carries the public key of the certificate's subject (the entity that owns the certificate, as defined in the <code>subject</code> field). The <code>subjectPublicKeyInfo</code> field also identifies which algorithm to use with the key.<a href="#section-2.2.1-3.7.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1-3.7.2.1">
                  <p id="section-2.2.1-3.7.2.1.1"><strong>SCION constraints</strong>: For constraints regarding the algorithm, see the <code>signature</code> field.<a href="#section-2.2.1-3.7.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-2.2.1-3.8">
              <p id="section-2.2.1-3.8.1"><code>issuerUniqueID</code> field: it <span class="bcp14">MUST NOT</span> be used in SCION.<a href="#section-2.2.1-3.8.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.1-3.9">
              <p id="section-2.2.1-3.9.1"><code>subjectUniqueID</code> field: it <span class="bcp14">MUST NOT</span> be used in SCION.<a href="#section-2.2.1-3.9.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.1-3.10">
              <p id="section-2.2.1-3.10.1"><code>extensions</code> sequence: Defines the extensions of the certificate. For a description of all extensions used in SCION, see <a href="#exts" class="auto internal xref">Section 2.2.2</a>.<a href="#section-2.2.1-3.10.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<div id="certsign">
<section id="section-2.2.1.1">
            <h5 id="name-signature-field-additional-">
<a href="#section-2.2.1.1" class="section-number selfRef">2.2.1.1. </a><a href="#name-signature-field-additional-" class="section-name selfRef"><code>signature</code> Field - Additional Information</a>
            </h5>
<p id="section-2.2.1.1-1">For security reasons, SCION uses a custom list of acceptable signature algorithms. This list of acceptable signature algorithms is specified in the <code>signature</code> field. The list currently only contains the ECDSA signature algorithm (defined in <a href="https://webstore.ansi.org/standards/ascx9/ansix9621998">X962</a>). However, the list might be extended in the future. The Object Identifiers (OIDs) for ECDSA are defined as <code>ecdsa-with-SHA256</code>, <code>ecdsa-with-SHA384</code>, and <code>ecdsa-with-SHA512</code> in <span>[<a href="#RFC5758" class="cite xref">RFC5758</a>]</span>.<a href="#section-2.2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-2.2.1.1-2"><strong>Important:</strong> The accepted cryptographic algorithms listed in this document are the only currently accepted cryptographic algorithms. SCION implementations <span class="bcp14">MUST</span> reject cryptographic algorithms not found in the list.<a href="#section-2.2.1.1-2" class="pilcrow">¶</a></p>
<p id="section-2.2.1.1-3">The only accepted curves for ECDSA are:<a href="#section-2.2.1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1.1-4.1">
                <p id="section-2.2.1.1-4.1.1">NIST P-256 (NISTFIPS186-4, section D.1.2.3) (named <code>secp256r1</code> in <span>[<a href="#RFC5480" class="cite xref">RFC5480</a>]</span>)<a href="#section-2.2.1.1-4.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.1-4.2">
                <p id="section-2.2.1.1-4.2.1">NIST P-384 (NISTFIPS186-4, section D.1.2.4) (named <code>secp384r1</code> in <span>[<a href="#RFC5480" class="cite xref">RFC5480</a>]</span>)<a href="#section-2.2.1.1-4.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.1-4.3">
                <p id="section-2.2.1.1-4.3.1">NIST P-521 (NISTFIPS186-4, section D.1.2.5) (named <code>secp521r1</code> in <span>[<a href="#RFC5480" class="cite xref">RFC5480</a>]</span>)<a href="#section-2.2.1.1-4.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.1.1-5">The OIDs for the above curves are specified in section 2.1.1.1 of <span>[<a href="#RFC5480" class="cite xref">RFC5480</a>]</span>.<a href="#section-2.2.1.1-5" class="pilcrow">¶</a></p>
<p id="section-2.2.1.1-6">The appropriate hash size to use when producing a signature with an ECDSA key is:<a href="#section-2.2.1.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1.1-7.1">
                <p id="section-2.2.1.1-7.1.1">ECDSA with SHA-256, for a P-256 signing key<a href="#section-2.2.1.1-7.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.1-7.2">
                <p id="section-2.2.1.1-7.2.1">ECDSA with SHA-384, for a P-384 signing key<a href="#section-2.2.1.1-7.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.1.1-7.3">
                <p id="section-2.2.1.1-7.3.1">ECDSA with SHA-512, for a P-521 signing key<a href="#section-2.2.1.1-7.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.1.1-8"><strong>Important:</strong> SCION implementations <span class="bcp14">MUST</span> include support for P-256, P-384, and P-521.<a href="#section-2.2.1.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuer">
<section id="section-2.2.1.2">
            <h5 id="name-issuer-field-additional-inf">
<a href="#section-2.2.1.2" class="section-number selfRef">2.2.1.2. </a><a href="#name-issuer-field-additional-inf" class="section-name selfRef"><code>issuer</code> Field - Additional Information</a>
            </h5>
<p id="section-2.2.1.2-1">The <code>issuer</code> field contains the distinguished name (DN) of the CA that created the certificate. <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>, section 4.1.2.4, describes the field's syntax and attributes. In addition to these attributes, SCION implementations <span class="bcp14">MUST</span> also support the SCION-specific attribute <code>ISD-AS number</code>. This attribute is specified below.<a href="#section-2.2.1.2-1" class="pilcrow">¶</a></p>
<div id="isd-as-nr">
<section id="section-2.2.1.2.1">
              <h6 id="name-isd-as-number-attribute">
<a href="#section-2.2.1.2.1" class="section-number selfRef">2.2.1.2.1. </a><a href="#name-isd-as-number-attribute" class="section-name selfRef"><code>ISD-AS number</code> Attribute</a>
              </h6>
<p id="section-2.2.1.2.1-1">The <code>ISD-AS number</code> attribute identifies the SCION ISD and AS. In the SCION open source implementation, the attribute type is <code>id-at-ia</code>, defined as:<br>
                <code>id-at-ia AttributeType ::= {id-scion id-cppki(1) id-at(2) 1}</code><a href="#section-2.2.1.2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.2.1.2.1-2">where <code>id-scion</code> specifies the root SCION object identifier (OID).<a href="#section-2.2.1.2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.2.1.2.1-3"><strong>Note</strong>: The root SCION object identifier (OID) for the SCION open-source implementation is the IANA Private Enterprise Number '55324':<br>
                <code>id-scion ::= OBJECT IDENTIFIER {1 3 6 1 4 1 55324}</code><a href="#section-2.2.1.2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.2.1.2.1-4">The following points apply when setting the attribute value of the <code>ISD-AS number</code> attribute:<a href="#section-2.2.1.2.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1.2.1-5.1">
                  <p id="section-2.2.1.2.1-5.1.1">The string representation <span class="bcp14">MUST</span> follow the canonical formatting defined in <a href="https://github.com/scionproto/scion/wiki/ISD-and-AS-numbering">ISD and AS numbering</a>.<a href="#section-2.2.1.2.1-5.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-2.2.1.2.1-5.2">
                  <p id="section-2.2.1.2.1-5.2.1">The canonical string representation uses a dash separator between the ISD and AS numbers.<a href="#section-2.2.1.2.1-5.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-2.2.1.2.1-5.3">
                  <p id="section-2.2.1.2.1-5.3.1">The ISD numbers are formatted as decimal.<a href="#section-2.2.1.2.1-5.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-2.2.1.2.1-5.4">
                  <p id="section-2.2.1.2.1-5.4.1">The canonical string formatting of AS numbers in the BGP AS range (0, 2<sup>32-1</sup>) is the decimal form. Larger AS numbers, i.e., from 2<sup>32</sup> to 2<sup>48-1</sup>, use a 16-bit, colon-separated, lower-case, hex encoding with leading zeros omitted: <code>1:0:0</code> to <code>ffff:ffff:ffff</code>.<a href="#section-2.2.1.2.1-5.4.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-2.2.1.2.1-6"><strong>Example:</strong> AS <code>ff00:0:110</code> in ISD <code>1</code> is formatted as <code>1-ff00:0:110</code>.<a href="#section-2.2.1.2.1-6" class="pilcrow">¶</a></p>
<p id="section-2.2.1.2.1-7">The <code>ISD-AS number</code> attribute <span class="bcp14">MUST</span> be present exactly once in the distinguished name of the certificate issuer or owner, specified in the <code>issuer</code> or <code>subject</code> field, respectively. Implementations <span class="bcp14">MUST NOT</span> create nor successfully verify certificates whose <code>issuer</code> and <code>subject</code> fields do not include the ISD-AS number at all, or include it more than once.<a href="#section-2.2.1.2.1-7" class="pilcrow">¶</a></p>
<p id="section-2.2.1.2.1-8"><strong>Note</strong>: Voting certificates are not required to include the <code>ISD-AS number</code> attribute in their distinguished name.<a href="#section-2.2.1.2.1-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="exts">
<section id="section-2.2.2">
          <h4 id="name-extensions">
<a href="#section-2.2.2" class="section-number selfRef">2.2.2. </a><a href="#name-extensions" class="section-name selfRef">Extensions</a>
          </h4>
<p id="section-2.2.2-1"><span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>, section 4.2.1, defines the syntax of the <code>Extensions</code> sequence in a X.509 certificate. Descriptions of each standard certificate extension can be found in <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>, section 4.2.1. The corresponding clauses in <a href="https://handle.itu.int/11.1002/1000/13031">X509</a> (10/2016) are clause 7.2 and clause 9, respectively.<a href="#section-2.2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2.2-2">Currently, the following extensions are relevant for SCION:<a href="#section-2.2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.2-3.1">
              <p id="section-2.2.2-3.1.1"><code>authorityKeyIdentifier</code><a href="#section-2.2.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.2-3.2">
              <p id="section-2.2.2-3.2.1"><code>subjectKeyIdentifier</code><a href="#section-2.2.2-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.2-3.3">
              <p id="section-2.2.2-3.3.1"><code>keyUsage</code><a href="#section-2.2.2-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.2-3.4">
              <p id="section-2.2.2-3.4.1"><code>extKeyUsage</code><a href="#section-2.2.2-3.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-2.2.2-3.5">
              <p id="section-2.2.2-3.5.1"><code>basicConstraints</code><a href="#section-2.2.2-3.5.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-2.2.2-4">The following sections describe the SCION-specifics in regard to these extensions.<a href="#section-2.2.2-4" class="pilcrow">¶</a></p>
<div id="authoritykeyidentifier-extension">
<section id="section-2.2.2.1">
            <h5 id="name-authoritykeyidentifier-exte">
<a href="#section-2.2.2.1" class="section-number selfRef">2.2.2.1. </a><a href="#name-authoritykeyidentifier-exte" class="section-name selfRef"><code>authorityKeyIdentifier</code> Extension</a>
            </h5>
<p id="section-2.2.2.1-1">The <code>authorityKeyIdentifier</code> extension identifies the public key corresponding to the private key used to sign a certificate.<a href="#section-2.2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.2.2.1-2">For the syntax and definition of the <code>authorityKeyIdentifier</code> extension, see <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>, section 4.2.1.1, and <a href="https://handle.itu.int/11.1002/1000/13031">X509</a>, clause 9.2.2.1.<a href="#section-2.2.2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.2.2.1-3">The <code>authorityKeyIdentifier</code> extension provides three attributes to specify the public key:<a href="#section-2.2.2.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.2.1-4.1">
                <p id="section-2.2.2.1-4.1.1"><code>keyIdentifier</code><a href="#section-2.2.2.1-4.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.1-4.2">
                <p id="section-2.2.2.1-4.2.1"><code>authorityCertIssuer</code><a href="#section-2.2.2.1-4.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.1-4.3">
                <p id="section-2.2.2.1-4.3.1"><code>authorityCertSerialNumber</code><a href="#section-2.2.2.1-4.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.2.1-5">In SCION, using the <code>keyIdentifier</code> attribute is the preferred way to specify the <code>authorityKeyIdentifier</code> extension.<a href="#section-2.2.2.1-5" class="pilcrow">¶</a></p>
<p id="section-2.2.2.1-6"><strong>Important:</strong> SCION implementations <span class="bcp14">MAY</span> also support the use of the <code>authorityCertIssuer</code> and <code>authorityCertSerialNumber</code> attributes. However, if these attributes are set and support for them is missing, implementations <span class="bcp14">SHOULD</span> error out.<a href="#section-2.2.2.1-6" class="pilcrow">¶</a></p>
<p id="section-2.2.2.1-7">This extension <span class="bcp14">MUST</span> always be non-critical. However, SCION implementations <span class="bcp14">MUST</span> error out if the extension is not present AND the certificate is not self-signed.<a href="#section-2.2.2.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="subject-key-id-ext">
<section id="section-2.2.2.2">
            <h5 id="name-subjectkeyidentifier-extens">
<a href="#section-2.2.2.2" class="section-number selfRef">2.2.2.2. </a><a href="#name-subjectkeyidentifier-extens" class="section-name selfRef"><code>subjectKeyIdentifier</code> Extension</a>
            </h5>
<p id="section-2.2.2.2-1">The <code>subjectKeyIdentifier</code> extension identifies certificates that contain a particular public key. It can be used, for example, by control-plane messages to identify which certificate to use for verification. The extension allows for overlapping control-plane CA keys, for example during updates.<a href="#section-2.2.2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2.2.2-2">For the syntax and definition of the <code>subjectKeyIdentifier</code> extension, see <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>, section 4.2.1.2, and <a href="https://handle.itu.int/11.1002/1000/13031">X509</a>, clause 9.2.2.2.<a href="#section-2.2.2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2.2.2-3">This extension <span class="bcp14">MUST</span> always be non-critical. However, SCION implementations <span class="bcp14">MUST</span> error out if the extension is not present.<a href="#section-2.2.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-usage-ext">
<section id="section-2.2.2.3">
            <h5 id="name-keyusage-extension">
<a href="#section-2.2.2.3" class="section-number selfRef">2.2.2.3. </a><a href="#name-keyusage-extension" class="section-name selfRef"><code>keyUsage</code> Extension</a>
            </h5>
<p id="section-2.2.2.3-1">The <code>keyUsage</code> extension identifies the intended usage of the public key in the corresponding certificate. For the syntax and definition of the <code>keyUsage</code> extension, see <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>, section 4.2.1.3, and <a href="https://handle.itu.int/11.1002/1000/13031">X509</a>, clause 9.2.2.3.<a href="#section-2.2.2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.2.2.3-2">The attributes of the <code>keyUsage</code> extension define possible ways of using the public key. The attributes have the following meaning in SCION:<a href="#section-2.2.2.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.2.3-3.1">
                <p id="section-2.2.2.3-3.1.1"><code>digitalSignature</code>: The public key can be used to verify the digital signature of a control-plane payload.<a href="#section-2.2.2.3-3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.3-3.2">
                <p id="section-2.2.2.3-3.2.1"><code>contentCommitment</code>: Not used.<a href="#section-2.2.2.3-3.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.3-3.3">
                <p id="section-2.2.2.3-3.3.1"><code>keyEncipherment</code>: Not used.<a href="#section-2.2.2.3-3.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.3-3.4">
                <p id="section-2.2.2.3-3.4.1"><code>dataEncipherment</code>: Not used.<a href="#section-2.2.2.3-3.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.3-3.5">
                <p id="section-2.2.2.3-3.5.1"><code>keyAgreement</code>: Not used.<a href="#section-2.2.2.3-3.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.3-3.6">
                <p id="section-2.2.2.3-3.6.1"><code>keyCertSign</code>: The public key can be used to verify the CA signature on a control-plane certificate.<a href="#section-2.2.2.3-3.6.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.3-3.7">
                <p id="section-2.2.2.3-3.7.1"><code>cRLSign</code>: Not used.<a href="#section-2.2.2.3-3.7.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.3-3.8">
                <p id="section-2.2.2.3-3.8.1"><code>encipherOnly</code>: Not used.<a href="#section-2.2.2.3-3.8.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.3-3.9">
                <p id="section-2.2.2.3-3.9.1"><code>decipherOnly</code>: Not used.<a href="#section-2.2.2.3-3.9.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.2.3-4"><strong>Important:</strong> If a certificate’s public key is used to verify the signature of a control-plane payload (<code>digitalSignature</code> attribute), it <span class="bcp14">MUST</span> be possible to trace back the private key used to sign the certificate. This is done by referencing the ISD-AS and the subject key identifier (via the <code>subjectKeyIdentifier</code> extension). For more information about the <code>subjectKeyIdentifier</code> extension, see <a href="#subject-key-id-ext" class="auto internal xref">Section 2.2.2.2</a>.<a href="#section-2.2.2.3-4" class="pilcrow">¶</a></p>
<p id="section-2.2.2.3-5">If present, the <code>keyUsage</code> extension <span class="bcp14">SHOULD</span> be marked as "critical". That is, the <code>critical</code> Boolean attribute of this extension <span class="bcp14">MUST</span> be set to TRUE (the default is FALSE).<a href="#section-2.2.2.3-5" class="pilcrow">¶</a></p>
<p id="section-2.2.2.3-6"><strong>Note</strong>: If a certificate extension is marked "critical", the public key in the certificate <span class="bcp14">SHOULD</span> only be used for the purpose set in the critical extension.<a href="#section-2.2.2.3-6" class="pilcrow">¶</a></p>
<p id="section-2.2.2.3-7">Each control-plane PKI certificate type uses the public key differently, and consequently also specifies the attributes of the <code>keyUsage</code> extension differently. The next table shows the specifications per certificate type.<a href="#section-2.2.2.3-7" class="pilcrow">¶</a></p>
<span id="name-keyusage-extension-specific"></span><div id="_table-4">
<table class="center" id="table-4">
              <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-keyusage-extension-specific" class="selfRef">keyUsage extension - Specifications per certificate type</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Certificate Type</th>
                  <th class="text-left" rowspan="1" colspan="1">Root</th>
                  <th class="text-left" rowspan="1" colspan="1">CA</th>
                  <th class="text-left" rowspan="1" colspan="1">AS</th>
                  <th class="text-left" rowspan="1" colspan="1">Voting (regular and sensitive)</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <em>Attribute:</em>
</td>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>keyUsage</code> extension itself</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST</span> be present</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST</span> be present</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST</span> be present</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MAY</span> be present (but is not required)</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>digitalSignature</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST NOT</span> be set (1)</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST NOT</span> be set (2)</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST</span> be set</td>
                  <td class="text-left" rowspan="1" colspan="1">If the extension is present, the <code>digitalSignature</code> attribute <span class="bcp14">MUST NOT</span> be set</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>keyCertSign</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST</span> be set</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST</span> be set</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST NOT</span> be set</td>
                  <td class="text-left" rowspan="1" colspan="1">If the extension is present, the <code>keyCertSign</code> attribute <span class="bcp14">MUST NOT</span> be set</td>
                </tr>
              </tbody>
            </table>
</div>
<p id="section-2.2.2.3-9">(1) The root certificate <span class="bcp14">SHOULD NOT</span> be used to verify control-plane messages.<br>
(2) The CA certificate <span class="bcp14">SHOULD NOT</span> be used to verify control-plane messages.<a href="#section-2.2.2.3-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ext-key-usage-ext">
<section id="section-2.2.2.4">
            <h5 id="name-extkeyusage-extension">
<a href="#section-2.2.2.4" class="section-number selfRef">2.2.2.4. </a><a href="#name-extkeyusage-extension" class="section-name selfRef"><code>extKeyUsage</code> Extension</a>
            </h5>
<p id="section-2.2.2.4-1">The <code>extKeyUsage</code> extension specifies additional usages of the public key in the certificate. For the syntax and definition of the <code>extKeyUsage</code> extension, see <a href="https://handle.itu.int/11.1002/1000/13031">X509</a>, clause 9.2.2.4.<a href="#section-2.2.2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.2.2.4-2">SCION uses the following attributes of the Extended Key Usage extension, as defined in Section 4.2.1.12 of <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>:<a href="#section-2.2.2.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.2.4-3.1">
                <p id="section-2.2.2.4-3.1.1"><code>id-kp-serverAuth</code>: If set, the public key can be used for SCION control-plane server authentication.<a href="#section-2.2.2.4-3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.4-3.2">
                <p id="section-2.2.2.4-3.2.1"><code>id-kp-clientAuth</code>: If set, the public key can be used for SCION control-plane client authentication.<a href="#section-2.2.2.4-3.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.4-3.3">
                <p id="section-2.2.2.4-3.3.1"><code>id-kp-timeStamping</code>: If set, the public key can be used for the verification of timestamps.<a href="#section-2.2.2.4-3.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.2.4-4">Additionally, the Extended Key Usage extension sequence <span class="bcp14">MAY</span> include the SCION-specific attributes <code>id-kp-root</code>, <code>id-kp-regular</code>, and <code>id-kp-sensitive</code>. These attributes are used in the Trust Root Configuration setup, to distinguish root certificates, regular voting certificates, and sensitive voting certificates from each other. For more information, see <a href="#cert" class="auto internal xref">Section 3.1.2.2.11</a>.<a href="#section-2.2.2.4-4" class="pilcrow">¶</a></p>
<p id="section-2.2.2.4-5">The specifications of the <code>extKeyUsage</code> extension differ per SCION control-plane PKI certificate type. The next table provides an overview of the specifications per certificate type.<a href="#section-2.2.2.4-5" class="pilcrow">¶</a></p>
<span id="name-extkeyusage-extension-speci"></span><div id="_table-5">
<table class="center" id="table-5">
              <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-extkeyusage-extension-speci" class="selfRef">extKeyUsage extension - Specifications per certificate type</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Certificate Type</th>
                  <th class="text-left" rowspan="1" colspan="1">Root</th>
                  <th class="text-left" rowspan="1" colspan="1">CA</th>
                  <th class="text-left" rowspan="1" colspan="1">AS</th>
                  <th class="text-left" rowspan="1" colspan="1">Voting (regular and sensitive)</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <em>Attribute:</em>
</td>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>extKeyUsage</code> extension itself</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST</span> be present</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MAY</span> be present (not required)</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST</span> be present</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST</span> be present</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>id-kp-serverAuth</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST NOT</span> be included</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST NOT</span> be included</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST</span> be included, if the certificate is used on the server-side of a control-plane TLS session.</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST NOT</span> be included</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>id-kp-clientAuth</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST NOT</span> be included</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST NOT</span> be included</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST</span> be included, if the certificate is used on the client-side of a control-plane TLS session.</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST NOT</span> be included</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>id-kp-timeStamping</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST</span> be included</td>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST</span> be included</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST</span> be included</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">SCION-specific</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>id-kp-root</code> <span class="bcp14">MUST</span> be included. For details, see <a href="#specatt" class="auto internal xref">Section 2.2.2.4.1</a>
</td>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1">Regular voting cert: <code>id-kp-regular</code> <span class="bcp14">MUST</span> be included. For details, see <a href="#specatt" class="auto internal xref">Section 2.2.2.4.1</a><br> Sensitive voting cert: <code>id-kp-sensitive</code> <span class="bcp14">MUST</span> be included. For details, see <a href="#specatt" class="auto internal xref">Section 2.2.2.4.1</a>
</td>
                </tr>
              </tbody>
            </table>
</div>
<div id="specatt">
<section id="section-2.2.2.4.1">
              <h6 id="name-scion-specific-attributes">
<a href="#section-2.2.2.4.1" class="section-number selfRef">2.2.2.4.1. </a><a href="#name-scion-specific-attributes" class="section-name selfRef">SCION-Specific Attributes</a>
              </h6>
<p id="section-2.2.2.4.1-1">The <code>id-kp-root</code>, <code>id-kp-regular</code>, and <code>id-kp-sensitive</code> attributes <span class="bcp14">MUST</span> be specified as follows:<a href="#section-2.2.2.4.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.2.4.1-2.1">
                  <p id="section-2.2.2.4.1-2.1.1">Root certificate:<br> <code>id-kp-root AttributeType ::= {id-scion id-cppki(1) id-kp(3) 3}</code><a href="#section-2.2.2.4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-2.2.2.4.1-2.2">
                  <p id="section-2.2.2.4.1-2.2.1">Regular voting certificate:<br> <code>id-kp-regular AttributeType ::= {id-scion id-cppki(1) id-kp(3) 2}</code><a href="#section-2.2.2.4.1-2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-2.2.2.4.1-2.3">
                  <p id="section-2.2.2.4.1-2.3.1">Sensitive voting certificate:<br> <code>id-kp-sensitive AttributeType ::= {id-scion id-cppki(1) id-kp(3) 1}</code><a href="#section-2.2.2.4.1-2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-2.2.2.4.1-3">where <code>id-scion</code> specifies the root SCION object identifier (OID).<a href="#section-2.2.2.4.1-3" class="pilcrow">¶</a></p>
<p id="section-2.2.2.4.1-4"><strong>Note</strong>: The root SCION object identifier (OID) for the SCION open-source implementation is the IANA Private Enterprise Number '55324':<br>
                <code>id-scion ::= OBJECT IDENTIFIER {1 3 6 1 4 1 55324}</code><a href="#section-2.2.2.4.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="basic-constr-ext">
<section id="section-2.2.2.5">
            <h5 id="name-basicconstraints-extension">
<a href="#section-2.2.2.5" class="section-number selfRef">2.2.2.5. </a><a href="#name-basicconstraints-extension" class="section-name selfRef"><code>basicConstraints</code> Extension</a>
            </h5>
<p id="section-2.2.2.5-1">The <code>basicConstraints</code> extension specifies whether the certificate subject may act as a CA. For the syntax and definition of the <code>basicConstraints</code> extension, see <a href="https://handle.itu.int/11.1002/1000/13031">X509</a>, clause 9.4.2.1.<a href="#section-2.2.2.5-1" class="pilcrow">¶</a></p>
<p id="section-2.2.2.5-2">The <code>basicConstraints</code> extension includes the following attributes relevant for SCION:<a href="#section-2.2.2.5-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.2.5-3.1">
                <p id="section-2.2.2.5-3.1.1"><code>cA</code> attribute: Specifies whether the certificate subject may act as a CA. If yes, this attribute <span class="bcp14">MUST</span> be set to TRUE.<a href="#section-2.2.2.5-3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-2.2.2.5-3.2">
                <p id="section-2.2.2.5-3.2.1"><code>pathLenConstraint</code> attribute: This attribute is only relevant if the <code>cA</code> attribute is set to TRUE. It specifies the maximum number of CA certificates that may follow this CA certificate in the certification chain. Value "0" means that this CA may only issue end-entity certificates, but no CA certificates. If the attribute is not set, there is no limit to the maximum length of the certification path.<a href="#section-2.2.2.5-3.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-2.2.2.5-4">The settings of the <code>basicConstraints</code> extension differ for each SCION control-plane PKI certificate type. The next table shows the specifications per certificate type.<a href="#section-2.2.2.5-4" class="pilcrow">¶</a></p>
<span id="name-basicconstraints-extension-"></span><div id="_table-6">
<table class="center" id="table-6">
              <caption>
<a href="#table-6" class="selfRef">Table 6</a>:
<a href="#name-basicconstraints-extension-" class="selfRef">basicConstraints extension - Specifications per certificate type</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Certificate Type</th>
                  <th class="text-left" rowspan="1" colspan="1">Root</th>
                  <th class="text-left" rowspan="1" colspan="1">CA</th>
                  <th class="text-left" rowspan="1" colspan="1">AS</th>
                  <th class="text-left" rowspan="1" colspan="1">Voting (regular and sensitive)</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <em>Attribute:</em>
</td>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>basicConstraints</code> extension itself</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST</span> be present</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST</span> be present</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">SHOULD NOT</span> be present</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">SHOULD NOT</span> be present</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>cA</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST</span> be set to TRUE</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">MUST</span> be set to TRUE</td>
                  <td class="text-left" rowspan="1" colspan="1">If the extension is present, this attribute <span class="bcp14">MUST</span> be set to FALSE</td>
                  <td class="text-left" rowspan="1" colspan="1">If the extension is present, this attribute <span class="bcp14">MUST</span> be set to FALSE</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>pathLenConstraint</code>
</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">SHOULD</span> be set to "1", <span class="bcp14">MUST</span> be marked as "critical"</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <span class="bcp14">SHOULD</span> be set to "0" (1), <span class="bcp14">MUST</span> be marked as "critical"</td>
                  <td class="text-left" rowspan="1" colspan="1">If the extension is present, this attribute <span class="bcp14">MUST</span> be absent.</td>
                  <td class="text-left" rowspan="1" colspan="1">If the extension is present, this attribute <span class="bcp14">MUST</span> be absent.</td>
                </tr>
              </tbody>
            </table>
</div>
<p id="section-2.2.2.5-6">(1) Control-plane CAs can only issue end-entity certificates.<a href="#section-2.2.2.5-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="trc-specification">
<section id="section-3">
      <h2 id="name-trust-root-configuration-sp">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-trust-root-configuration-sp" class="section-name selfRef">Trust Root Configuration Specification</a>
      </h2>
<p id="section-3-1">This section provides an in-depth specification of the trust root configuration (TRC) file (see <a href="#trc-spec" class="auto internal xref">Section 3.1</a>). The TRC contains policy information about an ISD and acts as a distribution mechanism for the trust anchors of that ISD. It enables securing the control-plane interactions, and is thus an integral part of the SCION infrastructure.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">The initial TRC of an ISD is signed during a signing ceremony and then distributed throughout the ISD. This signing ceremony follows specific rules; <a href="#trc-ceremony" class="auto internal xref">Section 3.2</a> describes these rules.<a href="#section-3-2" class="pilcrow">¶</a></p>
<div id="trc-spec">
<section id="section-3.1">
        <h3 id="name-trc-specification">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-trc-specification" class="section-name selfRef">TRC Specification</a>
        </h3>
<p id="section-3.1-1">The trust root configuration (TRC) is a signed collection of <a href="https://handle.itu.int/11.1002/1000/13031">X.509</a> v3 certificates. Additionally, the TRC contains ISD-specific policies encoded in a Cryptographic Message Syntax (CMS) <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span> envelope.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">The TRC's certificates collection consists of a set of control-plane root certificates, which build the root of the certification chain for the AS certificates in an ISD. The other certificates in the TRC are solely used for signing the next TRC, a process called "voting". The verification of a new TRC thus depends on the policies and voting certificates defined in the previous TRC.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3"><strong>Note:</strong> See <a href="#cert-specs" class="auto internal xref">Section 2</a> for the general specifications of SCION's control-plane PKI certificates, as well as <a href="#cp-root-cert" class="auto internal xref">Section 2.1.2</a> and <a href="#cp-voting-cert" class="auto internal xref">Section 2.1.5</a>, for the specifications of the control-plane root certificates and voting certificates, respectively.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">This section provides a detailed specification of the TRC. It presents the TRC format definitions and describes the TRC payload fields. The section uses the ITU-T <a href="https://handle.itu.int/11.1002/1000/14468">X.680</a> syntax.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<div id="trc-states">
<section id="section-3.1.1">
          <h4 id="name-trc-types-and-states">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-trc-types-and-states" class="section-name selfRef">TRC Types and States</a>
          </h4>
<p id="section-3.1.1-1">The following types of TRCs exist:<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.1-2.1">
              <p id="section-3.1.1-2.1.1">Initial: The very first TRC of an ISD is the initial TRC of that ISD. It is a special case of the base TRC, where the number of the ISD is specified.<a href="#section-3.1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.1-2.2">
              <p id="section-3.1.1-2.2.1">Base: A base TRC is either the initial TRC, or the first TRC after a trust reset (see <a href="#trust-reset" class="auto internal xref">Section 1.4.1</a>). Trust for a base TRC cannot be inferred by verifying a TRC update; base TRCs are trusted axiomatically, similarly to how root CA certificates are trusted by clients in the Web PKI.<a href="#section-3.1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.1-2.3">
              <p id="section-3.1.1-2.3.1">Update: All non-base TRCs are updated TRCs. They are the product of either a regular or a sensitive update.<a href="#section-3.1.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.1.1-3">A TRC can have the following states:<a href="#section-3.1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.1-4.1">
              <p id="section-3.1.1-4.1.1">Valid: The validity period of a TRC is defined in the TRC itself, in the <code>validity</code> field (see <a href="#validity" class="auto internal xref">Section 3.1.2.2.3</a>). A TRC is considered valid if the current time falls within its validity period.<a href="#section-3.1.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.1.1-4.2">
              <p id="section-3.1.1-4.2.1">Active: An active TRC is a valid TRC that can be used for verifying certificate signatures. This is either the latest TRC or the predecessor TRC, if it is still in its grace period (as defined in the <code>gracePeriod</code> field of the new TRC, see <a href="#grace" class="auto internal xref">Section 3.1.2.2.4</a>). No more than two TRCs can be active at the same time for any ISD.<a href="#section-3.1.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.1.1-5"><a href="#_figure-3" class="auto internal xref">Figure 3</a> shows the content of both a base/initial TRC and the first regularly-updated TRC based on the base TRC. All elements of the shown TRCs are specified in detail in the following subsections.<a href="#section-3.1.1-5" class="pilcrow">¶</a></p>
<span id="name-the-trc-on-the-left-hand-si"></span><div id="_figure-3">
<figure id="figure-3">
            <div class="alignLeft art-text artwork" id="section-3.1.1-6.1">
<pre>
+--------------------------------------------+        +--------------------------------------------+
|             TRC 1 (base, initial)          |        |             TRC 2 (regular update)         |
|+------------------------------------------+|        |+------------------------------------------+|
||- Version       - Core ASes               ||        ||- Version       - Core ASes               ||
||- ID            - Description             ||        ||- ID            - Description             ||
||- Validity      - No Trust Reset          ||        ||- Validity      - No Trust Reset          ||
||- Grace Period  - Voting Quorum           ||        ||- Grace Period  - Voting Quorum           ||
||- ...                                     ||        ||- ...                                     ||
|+------------------------------------------+|        |+------------------------------------------+|
|+--------------------++--------------------+|        |+--------------------++--------------------+|
||Votes (cert.indices)||   Regular Voting   ||        ||Votes (cert.indices)||   Regular Voting   ||
||                    ||    Certificates    ||        ||                    ||    Certificates    ||
||    (empty)         ||                    ||        ||    (1),(2)...      ||                    ||
||                    ||+-----+ +-----+     ||        ||                    ||+-----+ +-----+     ||
||                    ||| (1) | | (2) |     ||        ||                    ||| (1) | | (2) |     ||
||                    |||C    | |C    | ... ||        ||                    |||C    | |C    | ... ||
||                    ||| reg | | reg |     ||        ||                    ||| reg | | reg |     ||
|+--------------------+|+--+--+ +--+--+     ||        |+--------------------+|+-----+ +-----+     ||
|+--------------------+|   |       |        ||        |+--------------------+|                    ||
||                    ||   |       +--------++-----+  ||                    ||                    ||
||                    ||   +----------------++-+   |  ||                    ||                    ||
||    Signatures      |+--------------------+| |   |  ||    Signatures      |+--------------------+|
||                    |+--------------------+| |   |  ||                    |+--------------------+|
||+------------------+|| Sensitive Voting   || |   |  ||+------------------+|| Sensitive Voting   ||
|||73 A9 4E AO 0D ...|||    Certificates    || |   +--+&gt;|48 AE E4 80 DB ...|||    Certificates    ||
||+------------------+||+-----+ +-----+     || |      ||+------------------+||+-----+ +-----+     ||
||+------------------+||| (3) | | (4) |     || |      ||+------------------+||| (3) | | (4) |     ||
|||53 B7 7C 98 56 ...||||C    | |C    |     || +------+&gt;|7E BC 75 98 25 ...||||C    | |C    |     ||
||+------------------+||| sens| | sens| ... ||        ||+------------------+||| sens| | sens| ... ||
||        ...         ||+-----+ +-----+     ||        ||        ...         ||+-----+ +-----+     ||
|+--------------------++--------------------+|        |+--------------------++--------------------+|
|+------------------------------------------+|        |+------------------------------------------+|
||          CP Root Certificates            ||        ||          CP Root Certificates            ||
||                                          ||        ||                                          ||
|| +-----+ +-----+ +-----+ +-----+          ||        || +-----+ +-----+ +-----+ +-----+          ||
|| | (5) | | (6) | | (7) | | (8) |          ||        || | (5) | | (6) | | (7) | | (8) |          ||
|| |C    | |C    | |C    | |C    |          ||        || |C    | |C    | |C    | |C    |          ||
|| | root| | root| | root| | root| .....    ||        || | root| | root| | root| | root| .....    ||
|| +-----+ +-----+ +-----+ +-----+          ||        || +-----+ +-----+ +-----+ +-----+          ||
|+------------------------------------------+|        |+------------------------------------------+|
+--------------------------------------------+        +--------------------------------------------+
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-the-trc-on-the-left-hand-si" class="selfRef">The TRC on the left-hand side is the initial base TRC. The TRC on the right is the product of the first regular update of the base TRC.</a>
            </figcaption></figure>
</div>
</section>
</div>
<div id="trc-format">
<section id="section-3.1.2">
          <h4 id="name-trc-format">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-trc-format" class="section-name selfRef">TRC Format</a>
          </h4>
<p id="section-3.1.2-1">The trust root configuration (TRC) of an ISD defines the roots of trust of the ISD, and builds the base of the ISD's control-plane PKI. It holds the root and voting certificates of the ISD and defines the ISD's trust policy.<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
<div id="trcpayload">
<section id="section-3.1.2.1">
            <h5 id="name-trc-schema">
<a href="#section-3.1.2.1" class="section-number selfRef">3.1.2.1. </a><a href="#name-trc-schema" class="section-name selfRef">TRC Schema</a>
            </h5>
<p id="section-3.1.2.1-1">The following code block shows the format of a TRC specification file (the payload schema):<a href="#section-3.1.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1.2.1-2">
<pre>
   TRCPayload  ::=  SEQUENCE {
       version   TRCFormatVersion,
       iD        TRCID,
       validity  Validity,

       gracePeriod   INTEGER,
       noTrustReset  BOOLEAN DEFAULT FALSE,
       votes         SEQUENCE OF INTEGER (SIZE (1..255)),

       votingQuorum  INTEGER (1..255),

       coreASes           SEQUENCE OF ASN,
       authoritativeASes  SEQUENCE OF ASN,
       description        UTF8String (SIZE (0..1024)),

       certificates       SEQUENCE OF Certificate }

   TRCFormatVersion  ::=  INTEGER { v1(0) }

   TRCID  ::=  SEQUENCE {
       iSD           ISD,
       serialNumber  INTEGER (1..MAX),
       baseNumber    INTEGER (1..MAX) }

   ISD  ::=  INTEGER (1..65535)

   Validity  ::=  SEQUENCE {
       notBefore  Time,
       notAfter   Time }

   ASN  ::=  INTEGER (1..281474976710655)
</pre><a href="#section-3.1.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-3.1.2.1-3">The <code>TRCPayload</code> sequence contains the identifying information of a TRC as well as policy information for TRC updates. Furthermore, it defines the list of certificates that build the trust anchor of the ISD.<a href="#section-3.1.2.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1.2.1-4">For signature calculation, the data that is to be signed is encoded using ASN.1 distinguished encoding rules (DER) <a href="https://handle.itu.int/11.1002/1000/14472">X.690</a>. For more details, see <a href="#signed-format" class="auto internal xref">Section 3.1.3</a>.<a href="#section-3.1.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trc-fields">
<section id="section-3.1.2.2">
            <h5 id="name-trc-fields">
<a href="#section-3.1.2.2" class="section-number selfRef">3.1.2.2. </a><a href="#name-trc-fields" class="section-name selfRef">TRC Fields</a>
            </h5>
<p id="section-3.1.2.2-1">This section describes the syntax and semantics of all TRC payload fields.<a href="#section-3.1.2.2-1" class="pilcrow">¶</a></p>
<div id="version-field">
<section id="section-3.1.2.2.1">
              <h6 id="name-version-field">
<a href="#section-3.1.2.2.1" class="section-number selfRef">3.1.2.2.1. </a><a href="#name-version-field" class="section-name selfRef"><code>version</code> Field</a>
              </h6>
<p id="section-3.1.2.2.1-1">The <code>version</code> field describes the version of the TRC format specification.<a href="#section-3.1.2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1.2.2.1-2">Currently, the version <span class="bcp14">MUST</span> always be "v1".<a href="#section-3.1.2.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="id">
<section id="section-3.1.2.2.2">
              <h6 id="name-id-field">
<a href="#section-3.1.2.2.2" class="section-number selfRef">3.1.2.2.2. </a><a href="#name-id-field" class="section-name selfRef"><code>iD</code> Field</a>
              </h6>
<p id="section-3.1.2.2.2-1">The <code>iD</code> field specifies the unique identifier of the TRC.<a href="#section-3.1.2.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.1.2.2.2-2">The identifier is a unique sequence of<a href="#section-3.1.2.2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.2.2.2-3.1">
                  <p id="section-3.1.2.2.2-3.1.1">ISD number (<code>iSD</code> attribute),<a href="#section-3.1.2.2.2-3.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.1.2.2.2-3.2">
                  <p id="section-3.1.2.2.2-3.2.1">base number (<code>baseNumber</code> attribute), and<a href="#section-3.1.2.2.2-3.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.1.2.2.2-3.3">
                  <p id="section-3.1.2.2.2-3.3.1">TRC serial number (<code>serialNumber</code> attribute).<a href="#section-3.1.2.2.2-3.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-3.1.2.2.2-4">All numbers <span class="bcp14">MUST</span> be positive integers.<a href="#section-3.1.2.2.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.2.2.2-5.1">
                  <p id="section-3.1.2.2.2-5.1.1">The <strong>ISD number</strong> <span class="bcp14">MUST</span> be an integer in the inclusive range from 64 to 4094 (i.e., the numbering range for public ISDs, see <a href="#input" class="auto internal xref">Section 1.6.1</a>).<a href="#section-3.1.2.2.2-5.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.1.2.2.2-5.2">
                  <p id="section-3.1.2.2.2-5.2.1">The <strong>base number</strong> indicates the starting point of the current TRC update chain. This starting point is either the ISD's initial TRC or the currently valid base TRC, if the valid base TRC differs from the initial TRC. The latter <span class="bcp14">MUST</span> be the case after a trust reset.<a href="#section-3.1.2.2.2-5.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.1.2.2.2-5.3">
                  <p id="section-3.1.2.2.2-5.3.1">The <strong>serial number</strong> represents the current update cycle, counting from the initial TRC of a specific ISD.<a href="#section-3.1.2.2.2-5.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-3.1.2.2.2-6">A TRC where the base number is equal to the serial number is a base TRC. The initial TRC is a special case of a base TRC. An ISD's initial TRC <span class="bcp14">MUST</span> have a serial number of 1 and a base number of 1. With every TRC update, the serial number <span class="bcp14">MUST</span> be incremented by one. This facilitates uniquely identifying the predecessor and successor TRC in a TRC update chain.<a href="#section-3.1.2.2.2-6" class="pilcrow">¶</a></p>
<p id="section-3.1.2.2.2-7">If a trust reset is necessary, a new base TRC is announced, in order to start a new and clean TRC update chain. The base number of this new TRC update chain <span class="bcp14">SHOULD</span> be the number following the serial number of the latest TRC that was produced by a non-compromised TRC update for this ISD.<a href="#section-3.1.2.2.2-7" class="pilcrow">¶</a></p>
<p id="section-3.1.2.2.2-8"><strong>Example</strong><br>
The following simple example illustrates how to specify the ID of the TRCs in an TRC update chain for <em>ISD 74</em>. The IDs are given in a human-readable notation, where Bxx is the base number, and Sxx the serial number.<a href="#section-3.1.2.2.2-8" class="pilcrow">¶</a></p>
<span id="name-id-of-trcs-in-trc-update-ch"></span><div id="_table-7">
<table class="center" id="table-7">
                <caption>
<a href="#table-7" class="selfRef">Table 7</a>:
<a href="#name-id-of-trcs-in-trc-update-ch" class="selfRef">ID of TRCs in TRC update chain</a>
                </caption>
<thead>
                  <tr>
                    <th class="text-left" rowspan="1" colspan="1">Update</th>
                    <th class="text-left" rowspan="1" colspan="1">TRC ID</th>
                    <th class="text-left" rowspan="1" colspan="1">Remarks</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">Initial</td>
                    <td class="text-left" rowspan="1" colspan="1">ISD74-B01-S01</td>
                    <td class="text-left" rowspan="1" colspan="1"> </td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">Regular</td>
                    <td class="text-left" rowspan="1" colspan="1">ISD74-B01-S02</td>
                    <td class="text-left" rowspan="1" colspan="1">Only the serial number is incremented.</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">Regular</td>
                    <td class="text-left" rowspan="1" colspan="1">ISD74-B01-S03</td>
                    <td class="text-left" rowspan="1" colspan="1">Only the serial number is incremented.</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">Sensitive</td>
                    <td class="text-left" rowspan="1" colspan="1">ISD74-B01-S04</td>
                    <td class="text-left" rowspan="1" colspan="1">Only the serial number is incremented.</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">Trust reset</td>
                    <td class="text-left" rowspan="1" colspan="1">ISD74-<strong>B05</strong>-S05</td>
                    <td class="text-left" rowspan="1" colspan="1">A trust reset includes the creation of a new base TRC. The new base number follows the serial number "04" of the latest TRC resulting from a non-compromised TRC update for this ISD.</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">Regular</td>
                    <td class="text-left" rowspan="1" colspan="1">ISD74-B05-S06</td>
                    <td class="text-left" rowspan="1" colspan="1">Only the serial number is incremented.</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">Regular</td>
                    <td class="text-left" rowspan="1" colspan="1">ISD74-B05-S07</td>
                    <td class="text-left" rowspan="1" colspan="1">Only the serial number is incremented.</td>
                  </tr>
                  <tr>
                    <td class="text-left" rowspan="1" colspan="1">And so on</td>
                    <td class="text-left" rowspan="1" colspan="1"> </td>
                    <td class="text-left" rowspan="1" colspan="1"> </td>
                  </tr>
                </tbody>
              </table>
</div>
</section>
</div>
<div id="validity">
<section id="section-3.1.2.2.3">
              <h6 id="name-validity-field">
<a href="#section-3.1.2.2.3" class="section-number selfRef">3.1.2.2.3. </a><a href="#name-validity-field" class="section-name selfRef"><code>validity</code> Field</a>
              </h6>
<p id="section-3.1.2.2.3-1">The <code>validity</code> field defines the validity period of the TRC. This is the period of time during which the TRC is in the "valid" state. The <code>notBefore</code> and <code>notAfter</code> attributes of the <code>validity</code> field specify the lower and upper bound of the time interval during which a TRC can be active.<a href="#section-3.1.2.2.3-1" class="pilcrow">¶</a></p>
<p id="section-3.1.2.2.3-2"><strong>Note:</strong> An active TRC is a valid TRC that can be used for verifying certificate signatures. The time period during which a TRC is active can be shorter than the time period during which the TRC is valid. For more information, see <a href="#trc-states" class="auto internal xref">Section 3.1.1</a>.<a href="#section-3.1.2.2.3-2" class="pilcrow">¶</a></p>
<p id="section-3.1.2.2.3-3">The <code>validity</code> field consists of a sequence of two dates, as defined in section 7.2. of <a href="https://handle.itu.int/11.1002/1000/13031">X.509</a>.<a href="#section-3.1.2.2.3-3" class="pilcrow">¶</a></p>
<p id="section-3.1.2.2.3-4">In addition to this standard definition, the following constraint applies to the <code>validity</code> field of the TRC used in SCION:<a href="#section-3.1.2.2.3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.2.2.3-5.1">
                  <p id="section-3.1.2.2.3-5.1.1">All TRCs <span class="bcp14">MUST</span> have a well-defined expiration date. SCION implementations <span class="bcp14">MUST NOT</span> create TRCs that use the "99991231235959Z" generalized time value, and verifiers <span class="bcp14">MUST</span> error out when encountering such a TRC.<a href="#section-3.1.2.2.3-5.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</section>
</div>
<div id="grace">
<section id="section-3.1.2.2.4">
              <h6 id="name-graceperiod-field">
<a href="#section-3.1.2.2.4" class="section-number selfRef">3.1.2.2.4. </a><a href="#name-graceperiod-field" class="section-name selfRef"><code>gracePeriod</code> Field</a>
              </h6>
<p id="section-3.1.2.2.4-1">The <code>gracePeriod</code> field of a TRC specifies the period of time during which the predecessor TRC can still be considered active (the "grace period"). The grace period starts at the beginning of the validity period of the new TRC.<a href="#section-3.1.2.2.4-1" class="pilcrow">¶</a></p>
<p id="section-3.1.2.2.4-2">The validity period of the predecessor TRC ends when<a href="#section-3.1.2.2.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.2.2.4-3.1">
                  <p id="section-3.1.2.2.4-3.1.1">the grace period has passed,<a href="#section-3.1.2.2.4-3.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.1.2.2.4-3.2">
                  <p id="section-3.1.2.2.4-3.2.1">the predecessor’s expiration time is reached, or<a href="#section-3.1.2.2.4-3.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.1.2.2.4-3.3">
                  <p id="section-3.1.2.2.4-3.3.1">the successor TRC of the new TRC has been announced.<a href="#section-3.1.2.2.4-3.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-3.1.2.2.4-4"><strong>Note:</strong> The event that happens first marks the end of the predecessor's validity period.<a href="#section-3.1.2.2.4-4" class="pilcrow">¶</a></p>
<p id="section-3.1.2.2.4-5">The <code>gracePeriod</code> field defines the grace period as a number of seconds (positive integer).<a href="#section-3.1.2.2.4-5" class="pilcrow">¶</a></p>
<p id="section-3.1.2.2.4-6">The value of the <code>gracePeriod</code> field in a base TRC <span class="bcp14">MUST</span> be zero. The value of the <code>gracePeriod</code> field in a non-base TRC <span class="bcp14">SHOULD</span> be non-zero. It <span class="bcp14">SHOULD</span> be long enough to provide sufficient overlap between the TRCs in order to facilitate interruption-free operations in the ISD. If the grace period is too short, some control-plane AS certificates might expire before the corresponding AS can fetch an updated version from its CA.<a href="#section-3.1.2.2.4-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="notrustreset">
<section id="section-3.1.2.2.5">
              <h6 id="name-notrustreset-boolean">
<a href="#section-3.1.2.2.5" class="section-number selfRef">3.1.2.2.5. </a><a href="#name-notrustreset-boolean" class="section-name selfRef"><code>noTrustReset</code> Boolean</a>
              </h6>
<p id="section-3.1.2.2.5-1">The <code>noTrustReset</code> Boolean specifies whether a trust reset is forbidden by the ISD. Within a TRC update chain, this value <span class="bcp14">MUST NOT</span> be changed by a regular or sensitive update. However, it is possible to change the <code>noTrustReset</code> value in the event of a trust reset, where a new base TRC is created.<a href="#section-3.1.2.2.5-1" class="pilcrow">¶</a></p>
<p id="section-3.1.2.2.5-2">The <code>noTrustReset</code> field is <span class="bcp14">OPTIONAL</span> and defaults to FALSE.<a href="#section-3.1.2.2.5-2" class="pilcrow">¶</a></p>
<p id="section-3.1.2.2.5-3"><strong>Important:</strong> Note that once the <code>noTrustReset</code> Boolean is set to TRUE and a trust reset is disallowed, this cannot be reversed. Therefore, ISDs <span class="bcp14">SHOULD</span> always set this value to FALSE, unless they have sufficiently assessed the risks and implications of making a trust reset impossible.<a href="#section-3.1.2.2.5-3" class="pilcrow">¶</a></p>
<p id="section-3.1.2.2.5-4"><strong>Note:</strong> A trust reset represents a special use case where a new base TRC is created. It therefore differs from a TRC update (regular or sensitive), as the signatures in the new base TRC cannot be verified with the certificates contained in the predecessor TRC. Instead, a trust reset base TRC must be axiomatically trusted, similarly to how the initial TRC is trusted.<a href="#section-3.1.2.2.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="votes">
<section id="section-3.1.2.2.6">
              <h6 id="name-votes-field">
<a href="#section-3.1.2.2.6" class="section-number selfRef">3.1.2.2.6. </a><a href="#name-votes-field" class="section-name selfRef"><code>votes</code> Field</a>
              </h6>
<p id="section-3.1.2.2.6-1">The <code>votes</code> field contains a sequence of indices that refer to the voting certificates in the predecessor TRC. If index i is part of the <code>votes</code> field, then the voting certificate at position i in the <code>certificates</code> sequence of the predecessor TRC casted a vote on the successor TRC. For more information on the <code>certificates</code> sequence, see <a href="#cert" class="auto internal xref">Section 3.1.2.2.11</a>.<a href="#section-3.1.2.2.6-1" class="pilcrow">¶</a></p>
<p id="section-3.1.2.2.6-2"><strong>Note:</strong> In a base TRC, the <code>votes</code> sequence is empty.<a href="#section-3.1.2.2.6-2" class="pilcrow">¶</a></p>
<p id="section-3.1.2.2.6-3">Every entry in the <code>votes</code> sequence <span class="bcp14">MUST</span> be unique.<br>
Further restrictions on votes are discussed in <a href="#update" class="auto internal xref">Section 3.1.5</a>.<a href="#section-3.1.2.2.6-3" class="pilcrow">¶</a></p>
<p id="section-3.1.2.2.6-4"><strong>Note:</strong> The <code>votes</code> sequence of indices is mandatory in order to prevent stripping voting signatures from the TRC. Absence of the <code>votes</code> sequence makes it possible to transform a TRC with more voting signatures than the voting quorum into multiple verifiable TRCs with the same payload, but different voting signature sets. This would violate the requirement of uniqueness of a TRC.<a href="#section-3.1.2.2.6-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="quorum">
<section id="section-3.1.2.2.7">
              <h6 id="name-votingquorum-field">
<a href="#section-3.1.2.2.7" class="section-number selfRef">3.1.2.2.7. </a><a href="#name-votingquorum-field" class="section-name selfRef"><code>votingQuorum</code> Field</a>
              </h6>
<p id="section-3.1.2.2.7-1">The <code>votingQuorum</code> field defines the number of necessary votes on a successor TRC to make it verifiable.<a href="#section-3.1.2.2.7-1" class="pilcrow">¶</a></p>
<p id="section-3.1.2.2.7-2">A voting quorum greater than one will prevent a single entity from creating a malicious TRC update.<a href="#section-3.1.2.2.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="core">
<section id="section-3.1.2.2.8">
              <h6 id="name-coreases-field">
<a href="#section-3.1.2.2.8" class="section-number selfRef">3.1.2.2.8. </a><a href="#name-coreases-field" class="section-name selfRef"><code>coreASes</code> Field</a>
              </h6>
<p id="section-3.1.2.2.8-1">The <code>coreASes</code> field contains the AS numbers of the core ASes in this ISD.<a href="#section-3.1.2.2.8-1" class="pilcrow">¶</a></p>
<p id="section-3.1.2.2.8-2">Each core AS number <span class="bcp14">MUST</span> be unique in the sequence of core AS numbers. That is, each AS number <span class="bcp14">MUST</span> appear only once in the <code>coreASes</code> field.<a href="#section-3.1.2.2.8-2" class="pilcrow">¶</a></p>
<div id="revoking-or-assigning-core-status">
<section id="section-3.1.2.2.8.1">
                <h6 id="name-revoking-or-assigning-core-">
<a href="#section-3.1.2.2.8.1" class="section-number selfRef">3.1.2.2.8.1. </a><a href="#name-revoking-or-assigning-core-" class="section-name selfRef">Revoking or Assigning Core Status</a>
                </h6>
<ul class="normal">
<li class="normal" id="section-3.1.2.2.8.1-1.1">
                    <p id="section-3.1.2.2.8.1-1.1.1">To revoke the core status of a given AS, remove the respective AS number from the sequence of AS numbers in the <code>coreASes</code> field.<a href="#section-3.1.2.2.8.1-1.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-3.1.2.2.8.1-1.2">
                    <p id="section-3.1.2.2.8.1-1.2.1">To assign the core status to a given AS, add the respective AS number to the sequence of AS numbers in the <code>coreASes</code> field.<a href="#section-3.1.2.2.8.1-1.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
<p id="section-3.1.2.2.8.1-2"><strong>Important:</strong> Revoking or assigning the core status of/to an AS always requires a (sensitive) TRC update.<a href="#section-3.1.2.2.8.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="auth">
<section id="section-3.1.2.2.9">
              <h6 id="name-authoritativeases-field">
<a href="#section-3.1.2.2.9" class="section-number selfRef">3.1.2.2.9. </a><a href="#name-authoritativeases-field" class="section-name selfRef"><code>authoritativeASes</code> Field</a>
              </h6>
<p id="section-3.1.2.2.9-1">The <code>authoritativeASes</code> field contains the AS numbers of the authoritative ASes in this ISD.<a href="#section-3.1.2.2.9-1" class="pilcrow">¶</a></p>
<p id="section-3.1.2.2.9-2">Authoritative ASes are those ASes in an ISD that always have the latest TRCs of the ISD. As a consequence, authoritative ASes also start the announcement of a TRC update.<a href="#section-3.1.2.2.9-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.2.2.9-3.1">
                  <p id="section-3.1.2.2.9-3.1.1">Every authoritative AS <span class="bcp14">MUST</span> be a core AS and be listed in the <code>coreASes</code> field.<a href="#section-3.1.2.2.9-3.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.1.2.2.9-3.2">
                  <p id="section-3.1.2.2.9-3.2.1">Each authoritative AS number <span class="bcp14">MUST</span> be unique in the sequence of authoritative AS numbers. That is, each AS number <span class="bcp14">MUST NOT</span> appear more than once in the <code>authoritativeASes</code> field.<a href="#section-3.1.2.2.9-3.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<div id="revoking-or-assigning-authoritative-status">
<section id="section-3.1.2.2.9.1">
                <h6 id="name-revoking-or-assigning-autho">
<a href="#section-3.1.2.2.9.1" class="section-number selfRef">3.1.2.2.9.1. </a><a href="#name-revoking-or-assigning-autho" class="section-name selfRef">Revoking or Assigning Authoritative Status</a>
                </h6>
<ul class="normal">
<li class="normal" id="section-3.1.2.2.9.1-1.1">
                    <p id="section-3.1.2.2.9.1-1.1.1">To revoke the authoritative status of a given AS, remove the respective AS number from the sequence of AS numbers in the <code>authoritativeASes</code> field.<a href="#section-3.1.2.2.9.1-1.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-3.1.2.2.9.1-1.2">
                    <p id="section-3.1.2.2.9.1-1.2.1">To assign the authoritative status to a given AS, add the respective AS number to the sequence of AS numbers in the <code>authoritativeASes</code> field.<a href="#section-3.1.2.2.9.1-1.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
<p id="section-3.1.2.2.9.1-2"><strong>Important:</strong> Revoking or assigning the authoritative status of/to an AS always requires a (sensitive) TRC update.<a href="#section-3.1.2.2.9.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="description">
<section id="section-3.1.2.2.10">
              <h6 id="name-description-field">
<a href="#section-3.1.2.2.10" class="section-number selfRef">3.1.2.2.10. </a><a href="#name-description-field" class="section-name selfRef"><code>description</code> Field</a>
              </h6>
<p id="section-3.1.2.2.10-1">The <code>description</code> field contains a UTF-8 encoded string that describes the ISD.<a href="#section-3.1.2.2.10-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.2.2.10-2.1">
                  <p id="section-3.1.2.2.10-2.1.1">The <code>description</code> field <span class="bcp14">SHOULD NOT</span> be empty.<a href="#section-3.1.2.2.10-2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.1.2.2.10-2.2">
                  <p id="section-3.1.2.2.10-2.2.1">The description of the ISD <span class="bcp14">MUST</span> be in English. Additionally, the <code>description</code> field <span class="bcp14">MAY</span> contain information in other languages.<a href="#section-3.1.2.2.10-2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</section>
</div>
<div id="cert">
<section id="section-3.1.2.2.11">
              <h6 id="name-certificates-field">
<a href="#section-3.1.2.2.11" class="section-number selfRef">3.1.2.2.11. </a><a href="#name-certificates-field" class="section-name selfRef"><code>certificates</code> Field</a>
              </h6>
<p id="section-3.1.2.2.11-1">The voting ASes and the certification authorities (CAs) of an ISD are not specified explicitly in the ISD's TRC. Instead, this information is defined by the list of voting and root certificates in the <code>certificates</code> field of the TRC payload.<a href="#section-3.1.2.2.11-1" class="pilcrow">¶</a></p>
<p id="section-3.1.2.2.11-2">The <code>certificates</code> field is a sequence of self-signed X.509 certificates. Each certificate in the certificate sequence <span class="bcp14">MUST</span> be one of the following types:<a href="#section-3.1.2.2.11-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.2.2.11-3.1">
                  <p id="section-3.1.2.2.11-3.1.1">a sensitive voting certificate,<a href="#section-3.1.2.2.11-3.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.1.2.2.11-3.2">
                  <p id="section-3.1.2.2.11-3.2.1">a regular voting certificate, or<a href="#section-3.1.2.2.11-3.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.1.2.2.11-3.3">
                  <p id="section-3.1.2.2.11-3.3.1">a CP root certificate.<a href="#section-3.1.2.2.11-3.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-3.1.2.2.11-4">A certificate that is no control-plane root or voting certificate <span class="bcp14">MUST NOT</span> be included in the sequence of certificates in the <code>certificates</code> field.<a href="#section-3.1.2.2.11-4" class="pilcrow">¶</a></p>
<p id="section-3.1.2.2.11-5"><strong>Note</strong>: A certificate's type (voting or root) is specified in the <code>extKeyUsage</code> extension of the certificate, by means of the SCION-specific attributes <code>id-kp-regular</code>, <code>id-kp-sensitive</code>, and <code>id-kp-root</code>, respectively. For more information, see <a href="#ext-key-usage-ext" class="auto internal xref">Section 2.2.2.4</a>.<a href="#section-3.1.2.2.11-5" class="pilcrow">¶</a></p>
<p id="section-3.1.2.2.11-6">The following constraints <span class="bcp14">MUST</span> hold for each certificate in the <code>certificates</code> field of the TRC payload:<a href="#section-3.1.2.2.11-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.2.2.11-7.1">
                  <p id="section-3.1.2.2.11-7.1.1">Each certificate <span class="bcp14">MUST</span> be unique in the sequence of certificates. That is, each certificate <span class="bcp14">MUST NOT</span> appear more than once in the <code>certificates</code> field.<a href="#section-3.1.2.2.11-7.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.1.2.2.11-7.2">
                  <p id="section-3.1.2.2.11-7.2.1">The <code>issuer</code> / <code>serialNumber</code> pair for each certificate <span class="bcp14">MUST</span> be unique.<a href="#section-3.1.2.2.11-7.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.1.2.2.11-7.3">
                  <p id="section-3.1.2.2.11-7.3.1">If an ISD-AS number is present in the distinguished name of the certificate, this ISD number <span class="bcp14">MUST</span> be equal to the ISD number of the TRC (which is defined in the <code>iD</code> field (see <a href="#id" class="auto internal xref">Section 3.1.2.2.2</a>).<a href="#section-3.1.2.2.11-7.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.1.2.2.11-7.4">
                  <p id="section-3.1.2.2.11-7.4.1">Every certificate <span class="bcp14">MUST</span> have a validity period that fully contains the validity period of this TRC. That is, the <code>notBefore</code> date of this TRC's validity period <span class="bcp14">MUST</span> be equal to or later than the certificate's <code>notBefore</code> date, and the <code>notAfter</code> date of this TRC's validity period <span class="bcp14">MUST</span> be before or equal to the certificate's <code>notAfter</code> date.<a href="#section-3.1.2.2.11-7.4.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.1.2.2.11-7.5">
                  <p id="section-3.1.2.2.11-7.5.1">Per certificate type, every certificate distinguished name <span class="bcp14">MUST</span> be unique.<a href="#section-3.1.2.2.11-7.5.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-3.1.2.2.11-8">The following must hold for the entire sequence of certificates in the <code>certificates</code> field:<a href="#section-3.1.2.2.11-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.2.2.11-9.1">
                  <p id="section-3.1.2.2.11-9.1.1"><code>votingQuorum</code> &lt;= count (sensitive voting certificates) <br>
That is, the quorum defined in the TRC's <code>votingQuorum</code> field (<a href="#quorum" class="auto internal xref">Section 3.1.2.2.7</a>) <span class="bcp14">MUST</span> be smaller than or equal to the number of <em>sensitive</em> voting certificates specified in the TRC's <code>certificates</code> field.<a href="#section-3.1.2.2.11-9.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.1.2.2.11-9.2">
                  <p id="section-3.1.2.2.11-9.2.1"><code>votingQuorum</code> &lt;= count (regular voting certificates) <br>
That is, the quorum defined in the TRC's <code>votingQuorum</code> field (<a href="#quorum" class="auto internal xref">Section 3.1.2.2.7</a>) <span class="bcp14">MUST</span> be smaller than or equal to the number of <em>regular</em> voting certificates specified in the TRC's <code>certificates</code> field.<a href="#section-3.1.2.2.11-9.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="signed-format">
<section id="section-3.1.3">
          <h4 id="name-trc-signature-syntax">
<a href="#section-3.1.3" class="section-number selfRef">3.1.3. </a><a href="#name-trc-signature-syntax" class="section-name selfRef">TRC Signature Syntax</a>
          </h4>
<p id="section-3.1.3-1">A TRC contains policy information about an ISD and acts as a distribution mechanism for the trust anchors of that ISD. Each TRC (payload) is digitally signed. The syntax used to sign and encapsulate the TRC payload is the Cryptographic Message Syntax (CMS), as defined in <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>. The signed TRC payload is of the CMS signed-data content type, as defined in Section 5 of <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>, and encapsulated in a CMS <code>ContentInfo</code> element, as defined in Section 3 of <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>. For detailed information on the general syntax definitions of the Cryptographic Message Syntax, see sections 3 and 5 of <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>.<a href="#section-3.1.3-1" class="pilcrow">¶</a></p>
<div id="scion-specific-rules">
<section id="section-3.1.3.1">
            <h5 id="name-scion-specific-rules">
<a href="#section-3.1.3.1" class="section-number selfRef">3.1.3.1. </a><a href="#name-scion-specific-rules" class="section-name selfRef">SCION-specific rules</a>
            </h5>
<p id="section-3.1.3.1-1">SCION implementations have to fulfil the following additional rules, on top of the general syntax rules from <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>:<a href="#section-3.1.3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.3.1-2.1">
                <p id="section-3.1.3.1-2.1.1"><code>EncapsulatedContentInfo</code> sequence:<a href="#section-3.1.3.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.3.1-2.1.2.1">
                    <p id="section-3.1.3.1-2.1.2.1.1">The <code>eContentType</code> field <span class="bcp14">MUST</span> be set to "id-data".<a href="#section-3.1.3.1-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-3.1.3.1-2.1.2.2">
                    <p id="section-3.1.3.1-2.1.2.2.1">The content of the <code>eContent</code> field <span class="bcp14">MUST</span> be the DER-encoded TRC payload. This has the benefit that the format is backwards compatible with PKCS #7, as described in Section 5.2.1 of <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>.<a href="#section-3.1.3.1-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="normal" id="section-3.1.3.1-2.2">
                <p id="section-3.1.3.1-2.2.1"><code>SignedData</code> sequence:<a href="#section-3.1.3.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.3.1-2.2.2.1">
                    <p id="section-3.1.3.1-2.2.2.1.1">The <code>certificates</code> field <span class="bcp14">MUST</span> be left empty. The certificate pool used to verify a TRC update is already specified in the <code>certificates</code> field of the predecessor TRC's payload (see also <a href="#cert" class="auto internal xref">Section 3.1.2.2.11</a>).<a href="#section-3.1.3.1-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-3.1.3.1-2.2.2.2">
                    <p id="section-3.1.3.1-2.2.2.2.1">The <code>version</code> field <span class="bcp14">MUST</span> be set to "1". This is because SCION uses the "id-data" content type to encapsulate content info, and does not specify any certificate in the <code>SignedData</code> sequence (see also Section 5.1 of <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>).<a href="#section-3.1.3.1-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="normal" id="section-3.1.3.1-2.3">
                <p id="section-3.1.3.1-2.3.1"><code>SignerIdentifier</code> choice:<a href="#section-3.1.3.1-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.3.1-2.3.2.1">
                    <p id="section-3.1.3.1-2.3.2.1.1">The type of signer identifier chosen here <span class="bcp14">MUST</span> be <code>IssuerAndSerialNumber</code>.<a href="#section-3.1.3.1-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="normal" id="section-3.1.3.1-2.4">
                <p id="section-3.1.3.1-2.4.1"><code>SignerInfo</code> sequence:<a href="#section-3.1.3.1-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.3.1-2.4.2.1">
                    <p id="section-3.1.3.1-2.4.2.1.1">The <code>version</code> field <span class="bcp14">MUST</span> be set to "1". This is because SCION uses the <code>IssuerAndSerialNumber</code> type of signer identifier (see also Section 5.3 of <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>).<a href="#section-3.1.3.1-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-3.1.3.1-2.4.2.2">
                    <p id="section-3.1.3.1-2.4.2.2.1">The algorithm specified in the <code>signatureAlgorithm</code> field <span class="bcp14">MUST</span> be one of the algorithms supported by SCION (for details, see <span><a href="#certsign" class="internal xref">signature Field - Additional Information</a> (<a href="#certsign" class="auto internal xref">Section 2.2.1.1</a>)</span>).<a href="#section-3.1.3.1-2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-3.1.3.1-2.4.2.3">
                    <p id="section-3.1.3.1-2.4.2.3.1">The <code>digestAlgorithm</code> is determined by the algorithm specified in the <code>signatureAlgorithm</code> field.<a href="#section-3.1.3.1-2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</section>
</div>
<div id="trc-equality">
<section id="section-3.1.3.2">
            <h5 id="name-trc-equality">
<a href="#section-3.1.3.2" class="section-number selfRef">3.1.3.2. </a><a href="#name-trc-equality" class="section-name selfRef">TRC Equality</a>
            </h5>
<p id="section-3.1.3.2-1">The signer information in the signed TRC is part of an unordered set, per <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>. This implies that the signer information can be reordered without affecting verification. Certain operations, however, require TRCs to be equal, according to the following equality definition:<a href="#section-3.1.3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.1.3.2-2"><strong>Two TRCs are equal, if and only if their payloads are byte equal.</strong><a href="#section-3.1.3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.1.3.2-3">Two TRCs with byte equal payloads can be considered as equal, because the TRC payload exactly defines which signatures must be attached in the signed TRC:<a href="#section-3.1.3.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.3.2-4.1">
                <p id="section-3.1.3.2-4.1.1">The <span class="bcp14">REQUIRED</span> signatures from voting certificates are explicitly mentioned in the <code>votes</code> field of the payload: If index "i" is part of the <code>votes</code> field, then the voting certificate at position i in the <code>certificates</code> sequence of the predecessor TRC casted a vote on the successor TRC. See also <a href="#votes" class="auto internal xref">Section 3.1.2.2.6</a>.<a href="#section-3.1.3.2-4.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1.3.2-4.2">
                <p id="section-3.1.3.2-4.2.1">The <span class="bcp14">REQUIRED</span> signatures for new certificates are implied by the currently valid TRC payload, and, in case of a TRC update, the predecessor payload.<a href="#section-3.1.3.2-4.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
</section>
</div>
<div id="certification-path-trust-anchor-pool">
<section id="section-3.1.4">
          <h4 id="name-certification-path-trust-an">
<a href="#section-3.1.4" class="section-number selfRef">3.1.4. </a><a href="#name-certification-path-trust-an" class="section-name selfRef">Certification Path - Trust Anchor Pool</a>
          </h4>
<p id="section-3.1.4-1">The certification path of a control-plane AS certificate starts in a control-plane root certificate. The control-plane root certificates for a given ISD are distributed via the TRC. However, AS certificates and the corresponding signing CA certificates are <strong>not</strong> part of the TRC, but bundled into certificate chains and distributed separately from the corresponding TRC. This separation makes it possible to extend the validity period of the root certificate, and to update the corresponding TRC, without having to modify the certificate chain. To be able to validate a certification path, each AS  build a collection of root certificates from the latest TRC of the relevant ISD. The following section explains how to build a trust anchor pool.<a href="#section-3.1.4-1" class="pilcrow">¶</a></p>
<p id="section-3.1.4-2"><strong>Note:</strong> Any entity sending information that is secured by the CP-PKI, such as control-plane messages, <span class="bcp14">MUST</span> be able to provide all the necessary trust material, such as certificates, to verify said information. If any cryptographic material is missing in the process, the relying party <span class="bcp14">MUST</span> query the originator of the message for the missing material. If it cannot be resolved, the verification process fails. For more details, see 4.2 "Signing and Verifying Control-Plane Messages" <a href="#signing-verifying-cp-messages" class="auto internal xref">Section 4.2</a>.<a href="#section-3.1.4-2" class="pilcrow">¶</a></p>
<div id="trc-selection">
<section id="section-3.1.4.1">
            <h5 id="name-trc-selection-for-trust-anc">
<a href="#section-3.1.4.1" class="section-number selfRef">3.1.4.1. </a><a href="#name-trc-selection-for-trust-anc" class="section-name selfRef">TRC Selection For Trust Anchor Pool</a>
            </h5>
<p id="section-3.1.4.1-1">The selection of the right set of TRCs to build the trust anchor pool depends on the time of verification. The trust anchor pool is usually used to verify control-plane messages. In this case, the time of verification is the current time. However, if the trust anchor pool will be used for auditing, the time of verification is the point in time for which you want to check whether a given signature was verifiable.<a href="#section-3.1.4.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1.4.1-2">The selection algorithm for building the trust anchor pool is described in pseudo-python code below.<a href="#section-3.1.4.1-2" class="pilcrow">¶</a></p>
<div class="breakable lang-python sourcecode" id="section-3.1.4.1-3">
<pre>
    def select_trust_anchors(trcs: Dict[(int,int), TRC], verification_time: int) -&gt; Set[RootCert]:
        """
        Args:
            trcs: The dictionary mapping (serial number, base number) to the TRC for a given ISD.
            verification_time: The time of verification.

        Returns:
            The set of CP Root certificates that act as trust anchors.
        """
        # Find highest base number that has a TRC with a validity period
        # starting before verification time.
        base_nr = 1
        for trc in trcs.values():
            if trc.id.base_nr &gt; base_nr and trc.validity.not_before &lt;= verification_time:
                base_nr = trc.id.base_nr

        # Find TRC with highest serial number with the given base number and a
        # validity period starting before verification time.
        serial_nr = 1
        for trc in trcs[isd].values():
            if trc.id.base_nr != base_nr:
                continue
            if trc.id.serial_nr &gt; serial_nr and trc.validity.not_before &lt;= verification_time:
                serial_nr = trc.id.serial_nr

        candidate = trcs[(serial_nr, base_nr)]

        # If the verification time is not inside the validity period,
        # there is no valid set of trust anchors.
        if not candidate.validity.contains(verification_time):
            return set()

        # If the grace period has passed, only the certificates in that TRCs
        # may be used as trust anchors.
        if candidate.validity.not_before + candidate.grace_period &lt; verification_time:
            return collect_trust_anchors(candidate)

        predecessor = trcs.get((serial_nr-1, base_nr))
        if not predecessor or predecessor.validity.not_after &lt; verification_time:
            return collect_trust_anchors(candidate)

        return collect_trust_anchors(candidate) | collect_trust_anchors(predecessor)


    def collect_trust_anchors(trc: TRC) -&gt; Set[RootCert]:
        """
        Args:
            trc: A TRC from which the CP Root Certificates shall be extracted.

        Returns:
            The set of CP Root certificates that act as trust anchors.
        """
        roots = set()
        for cert in trc.certificates:
            if not cert.basic_constraints.ca:
                continue
            roots.add(cert)
        return roots
</pre><a href="#section-3.1.4.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="update">
<section id="section-3.1.5">
          <h4 id="name-trc-updates">
<a href="#section-3.1.5" class="section-number selfRef">3.1.5. </a><a href="#name-trc-updates" class="section-name selfRef">TRC Updates</a>
          </h4>
<p id="section-3.1.5-1">All non-base TRCs of an ISD are updates of the ISD's base TRC(s). The TRC update chain consists of regular and sensitive TRC updates. The type of update determines the (payload) information that changes in the updated TRC. This section describes the rules that apply to updating a TRC in regard to the payload information contained in the TRC. Some rules are valid for both update types, some only apply to a regular or a sensitive TRC update, respectively. Based on the type of update, a different set of voters is necessary to create a verifiable TRC update - the section includes a description of the corresponding voting (signing) process. To verify a TRC update, a relying party <span class="bcp14">MUST</span> perform a couple of checks. These checks are listed at the end of the section.<a href="#section-3.1.5-1" class="pilcrow">¶</a></p>
<div id="change-new">
<section id="section-3.1.5.1">
            <h5 id="name-changed-or-new-certificates">
<a href="#section-3.1.5.1" class="section-number selfRef">3.1.5.1. </a><a href="#name-changed-or-new-certificates" class="section-name selfRef">Changed or New Certificates</a>
            </h5>
<p id="section-3.1.5.1-1">In the context of a TRC update,<a href="#section-3.1.5.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.5.1-2.1">
                <p id="section-3.1.5.1-2.1.1">A certificate is <em>changing</em>, if the certificate is part of the <code>certificates</code> sequence in the predecessor TRC, but no longer part of the <code>certificates</code> sequence in the updated TRC. Instead, the <code>certificates</code> sequence of the updated TRC holds another certificate of the <em>same type</em> and with the <em>same distinguished name</em>.<a href="#section-3.1.5.1-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1.5.1-2.2">
                <p id="section-3.1.5.1-2.2.1">A certificate is <em>new</em>, if there is <strong>no</strong> certificate of the same type and distinguished name at all in the <code>certificates</code> sequence of the predecessor TRC.<a href="#section-3.1.5.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.1.5.1-3"><strong>Note:</strong> Every new sensitive or regular voting certificate in a TRC attaches a signature to the TRC. This is done to ensure that the freshly included voting entity agrees with the contents of the TRC it is now part of.<a href="#section-3.1.5.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="update-rules-overview">
<section id="section-3.1.5.2">
            <h5 id="name-update-rules-overview">
<a href="#section-3.1.5.2" class="section-number selfRef">3.1.5.2. </a><a href="#name-update-rules-overview" class="section-name selfRef">Update Rules - Overview</a>
            </h5>
<p id="section-3.1.5.2-1">The following table gives an overview of the types of TRC update as well as the rules that must apply in regard to the updated TRC's payload information.<br>
The sections that follow provide more detailed descriptions of each rule.<a href="#section-3.1.5.2-1" class="pilcrow">¶</a></p>
<span id="name-overview-of-the-update-type"></span><div id="_table-8">
<table class="center" id="table-8">
              <caption>
<a href="#table-8" class="selfRef">Table 8</a>:
<a href="#name-overview-of-the-update-type" class="selfRef">Overview of the update types and corresponding rules</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Type of Update</th>
                  <th class="text-left" rowspan="1" colspan="1">Payload Updated TRC - Unchanged Elements</th>
                  <th class="text-left" rowspan="1" colspan="1">Payload Updated TRC - Required Changes</th>
                  <th class="text-left" rowspan="1" colspan="1">Payload Updated TRC: Other Rules to Hold</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Both Regular AND Sensitive Updates</td>
                  <td class="text-left" rowspan="1" colspan="1">- <code>iD</code> field: <code>iSD</code> and <code>baseNumber</code> <br> - <code>noTrustReset</code> field</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>iD</code> field: <code>serialNumber</code> <span class="bcp14">MUST</span> be incremented by 1</td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>votes</code> field: Number of votes (indices) =&gt; number set in the <code>votingQuorum</code> field of the predecessor TRC</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Regular TRC Update</td>
                  <td class="text-left" rowspan="1" colspan="1">- Quorum in the <code>votingQuorum</code> field<br>- Core ASes in the <code>coreASes</code> field<br>- ASes in the <code>authoritativeASes</code> field<br>- Nr. and distinguished names of root &amp; voting certificates in the <code>certificates</code> field<br>- Set of sensitive voting certificates in the <code>certificates</code> field</td>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>votes</code> field:<br> - All votes <span class="bcp14">MUST</span> only refer to <em>regular</em> voting certificates in the predecessor TRC<br>- Must include votes of each changed regular voting certificate from the predecessor TRC<br> <code>signatures</code> field:<br> - Must include signatures of each changed root certificate from the predecessor TRC</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">Sensitive TRC Update</td>
                  <td class="text-left" rowspan="1" colspan="1">If the update does not qualify as a regular update, it is a sensitive update</td>
                  <td class="text-left" rowspan="1" colspan="1"> </td>
                  <td class="text-left" rowspan="1" colspan="1">
                    <code>votes</code> field: <br> - All votes <span class="bcp14">MUST</span> only refer to <em>sensitive</em> voting certificates in the predecessor TRC</td>
                </tr>
              </tbody>
            </table>
</div>
</section>
</div>
<div id="general-update-rules">
<section id="section-3.1.5.3">
            <h5 id="name-general-update-rules">
<a href="#section-3.1.5.3" class="section-number selfRef">3.1.5.3. </a><a href="#name-general-update-rules" class="section-name selfRef">General Update Rules</a>
            </h5>
<p id="section-3.1.5.3-1">The following rules <span class="bcp14">MUST</span> hold for each updated TRC, independent of the update type:<a href="#section-3.1.5.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.5.3-2.1">
                <p id="section-3.1.5.3-2.1.1">The <code>iSD</code> and <code>baseNumber</code> in the <code>iD</code> field <span class="bcp14">MUST NOT</span> change (see also <a href="#id" class="auto internal xref">Section 3.1.2.2.2</a>).<a href="#section-3.1.5.3-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1.5.3-2.2">
                <p id="section-3.1.5.3-2.2.1">The <code>serialNumber</code> in the <code>iD</code> field <span class="bcp14">MUST</span> be incremented by one.<a href="#section-3.1.5.3-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1.5.3-2.3">
                <p id="section-3.1.5.3-2.3.1">The <code>noTrustReset</code> field <span class="bcp14">MUST NOT</span> change (see also <a href="#notrustreset" class="auto internal xref">Section 3.1.2.2.5</a>).<a href="#section-3.1.5.3-2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1.5.3-2.4">
                <p id="section-3.1.5.3-2.4.1">The <code>votes</code> sequence of the updated TRC <span class="bcp14">MUST</span> only contain indices that refer to sensitive or regular voting certificates in the predecessor TRC. This guarantees that the updated TRC only contains valid votes authenticated by sensitive or regular voting certificates in the predecessor TRC. For more information, see <a href="#votes" class="auto internal xref">Section 3.1.2.2.6</a> and <a href="#cert" class="auto internal xref">Section 3.1.2.2.11</a>.<a href="#section-3.1.5.3-2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1.5.3-2.5">
                <p id="section-3.1.5.3-2.5.1">The number of votes in the updated TRC <span class="bcp14">MUST</span> be greater than or equal to the number set in the <code>votingQuorum</code> field of the predecessor TRC (see <a href="#quorum" class="auto internal xref">Section 3.1.2.2.7</a>). The number of votes corresponds to the number of indices in the <code>votes</code> field of the updated TRC.<a href="#section-3.1.5.3-2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="regular-trc-update">
<section id="section-3.1.5.4">
            <h5 id="name-regular-trc-update">
<a href="#section-3.1.5.4" class="section-number selfRef">3.1.5.4. </a><a href="#name-regular-trc-update" class="section-name selfRef">Regular TRC Update</a>
            </h5>
<p id="section-3.1.5.4-1">A regular TRC update is a periodic re-issuance of the TRC where the entities and policies listed in the TRC remain unchanged.<a href="#section-3.1.5.4-1" class="pilcrow">¶</a></p>
<p id="section-3.1.5.4-2">A TRC update qualifies as a regular update, if the following rules apply in regard to the TRC's payload information.<a href="#section-3.1.5.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.5.4-3.1">
                <p id="section-3.1.5.4-3.1.1">The settings of the following fields in the updated TRC <span class="bcp14">MUST</span> remain the same compared to the predecessor TRC:<a href="#section-3.1.5.4-3.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.5.4-3.1.2.1">
                    <p id="section-3.1.5.4-3.1.2.1.1">The voting quorum set in the <code>votingQuorum</code> field.<a href="#section-3.1.5.4-3.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-3.1.5.4-3.1.2.2">
                    <p id="section-3.1.5.4-3.1.2.2.1">The core ASes specified in the <code>coreASes</code> field.<a href="#section-3.1.5.4-3.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-3.1.5.4-3.1.2.3">
                    <p id="section-3.1.5.4-3.1.2.3.1">The authoritative ASes specified in the <code>authoritativeASes</code> field.<a href="#section-3.1.5.4-3.1.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-3.1.5.4-3.1.2.4">
                    <p id="section-3.1.5.4-3.1.2.4.1">The number of sensitive and regular voting certificates as well as CP root certificates included in the <code>certificates</code> field, and their distinguished names.<a href="#section-3.1.5.4-3.1.2.4.1" class="pilcrow">¶</a></p>
</li>
                  <li class="normal" id="section-3.1.5.4-3.1.2.5">
                    <p id="section-3.1.5.4-3.1.2.5.1">The set of sensitive voting certificates specified in the <code>certificates</code> field.<a href="#section-3.1.5.4-3.1.2.5.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="normal" id="section-3.1.5.4-3.2">
                <p id="section-3.1.5.4-3.2.1">For every regular voting certificate that changes, the regular voting certificate in the predecessor TRC is part of the voters on the updated TRC. That is, for each changed regular voting certificate, an index in the <code>votes</code> field of the updated TRC <span class="bcp14">MUST</span> refer to the changed regular voting certificate in the predecessor TRC.<a href="#section-3.1.5.4-3.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1.5.4-3.3">
                <p id="section-3.1.5.4-3.3.1">For every CP root certificate that changes, the updated TRC <span class="bcp14">MUST</span> include a signature created with the private key belonging to the changed CP root certificate (which is part of the predecessor TRC).<a href="#section-3.1.5.4-3.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1.5.4-3.4">
                <p id="section-3.1.5.4-3.4.1">In order for a regular TRC update to be verifiable, all votes <span class="bcp14">MUST</span> be cast by <em>regular</em> voting certificates. That is, each index in the <code>votes</code> field of the regularly updated TRC <span class="bcp14">MUST</span> refer to a <em>regular</em> voting certificate in the <code>certificates</code> field of the predecessor TRC.<a href="#section-3.1.5.4-3.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="sensitive-trc-update">
<section id="section-3.1.5.5">
            <h5 id="name-sensitive-trc-update">
<a href="#section-3.1.5.5" class="section-number selfRef">3.1.5.5. </a><a href="#name-sensitive-trc-update" class="section-name selfRef">Sensitive TRC Update</a>
            </h5>
<p id="section-3.1.5.5-1">If a TRC update does not qualify as a regular update, it is considered a sensitive update.<a href="#section-3.1.5.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.5.5-2.1">
                <p id="section-3.1.5.5-2.1.1">In order for a sensitive update to be verifiable, all votes <span class="bcp14">MUST</span> be cast by <em>sensitive</em> voting certificates. That is, each index in the <code>votes</code> field of the sensitively updated TRC <span class="bcp14">MUST</span> refer to a <em>sensitive</em> voting certificate in the <code>certificates</code> field of the predecessor TRC.<a href="#section-3.1.5.5-2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="signing-a-trc-update">
<section id="section-3.1.5.6">
            <h5 id="name-signing-a-trc-update">
<a href="#section-3.1.5.6" class="section-number selfRef">3.1.5.6. </a><a href="#name-signing-a-trc-update" class="section-name selfRef">Signing a TRC Update</a>
            </h5>
<p id="section-3.1.5.6-1">As described above, a set of voters <span class="bcp14">MUST</span> cast votes on the updated TRC to make it verifiable. The <code>votingQuorum</code> field of the predecessor TRC (see <a href="#quorum" class="auto internal xref">Section 3.1.2.2.7</a>) defines the required number of voters, which will represent regular or sensitive voting certificates, respectively. Furthermore, if one or more <em>new</em> certificates are added to the updated TRC, the corresponding voting representatives <span class="bcp14">MUST</span> also sign the updated TRC, in order to show that they have access to the private keys listed in these fresh certificates. This is called "showing proof-of-possession", and done by signing the TRC with the respective private key. For the distinction between changed and new certificates in a TRC update, see <a href="#change-new" class="auto internal xref">Section 3.1.5.1</a>.<a href="#section-3.1.5.6-1" class="pilcrow">¶</a></p>
<p id="section-3.1.5.6-2">It is up to the ISD members to decide how the "casting a vote" procedure for updated TRCs will take place. Some ISDs will make a distinction between regular and sensitive updates. These ISDs divide the regular and sensitive signing keys in different security classes and act accordingly. For example, they keep the regular key in an online vault while the sensitive key would be stored offline in cold storage. This way, the regular TRC update would lend itself to being automated (since the keys are accessible online) whereas the sensitive one would require manual actions to access the offline key. Other ISDs, however, keep both regular and sensitive keys online and perform both updates automatically.<a href="#section-3.1.5.6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trc-update-verification">
<section id="section-3.1.5.7">
            <h5 id="name-trc-update-verification">
<a href="#section-3.1.5.7" class="section-number selfRef">3.1.5.7. </a><a href="#name-trc-update-verification" class="section-name selfRef">TRC Update Verification</a>
            </h5>
<p id="section-3.1.5.7-1">To verify a TRC update, the relying party <span class="bcp14">MUST</span> perform the following checks:<a href="#section-3.1.5.7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.5.7-2.1">
                <p id="section-3.1.5.7-2.1.1">Check that the specified update rules as described above are respected.<a href="#section-3.1.5.7-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.1.5.7-2.2">
                <p id="section-3.1.5.7-2.2.1">Check whether the update is regular or sensitive.<a href="#section-3.1.5.7-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.5.7-2.2.2.1">
                    <p id="section-3.1.5.7-2.2.2.1.1">In case of a regular update,<a href="#section-3.1.5.7-2.2.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1.5.7-2.2.2.1.2.1">
                        <p id="section-3.1.5.7-2.2.2.1.2.1.1">check that the signatures for the changing certificates are present and verifiable, and<a href="#section-3.1.5.7-2.2.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                      <li class="normal" id="section-3.1.5.7-2.2.2.1.2.2">
                        <p id="section-3.1.5.7-2.2.2.1.2.2.1">check that all votes are cast by a regular voting certificate.<a href="#section-3.1.5.7-2.2.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                    </ul>
</li>
                  <li class="normal" id="section-3.1.5.7-2.2.2.2">
                    <p id="section-3.1.5.7-2.2.2.2.1">In case of a sensitive update, check that all votes are cast by a sensitive voting certificate.<a href="#section-3.1.5.7-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="normal" id="section-3.1.5.7-2.3">
                <p id="section-3.1.5.7-2.3.1">In both cases, check that all signatures are verifiable, and no superfluous signatures are attached.<a href="#section-3.1.5.7-2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.1.5.7-3">If one or more of the above checks gives a negative result, the updated TRC <span class="bcp14">SHOULD</span> be rejected.<a href="#section-3.1.5.7-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="trc-ceremony">
<section id="section-3.2">
        <h3 id="name-initial-trc-signing-ceremon">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-initial-trc-signing-ceremon" class="section-name selfRef">Initial TRC Signing Ceremony</a>
        </h3>
<p id="section-3.2-1">The very first base TRC of an ISD, called the initial TRC, is a special case of the base TRC where the number of the ISD is chosen. The initial TRC <span class="bcp14">MUST</span> be signed during a special signing ceremony--all voting representatives of the initial TRC need to take part in this signing ceremony to sign the agreed-upon TRC. As part of the ceremony, the public keys of all voters are exchanged. The TRC is then distributed throughout the ISD. All entities within an ISD can initially obtain an authentic TRC, by means of a secure off- or online mechanism.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2"><a href="#initial-ceremony" class="auto internal xref">Appendix "Appendix A. Signing Ceremony Initial TRC"</a> describes a possible procedure for the signing ceremony of an ISD's initial TRC. It is in principle up to the initial members of an ISD how to shape the signing ceremony. However, it is recommended having a process in line with the ceremony described in the Appendix.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="deploy-cp-pki">
<section id="section-4">
      <h2 id="name-deploying-the-cp-pki-specif">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-deploying-the-cp-pki-specif" class="section-name selfRef">Deploying the CP PKI - Specifications</a>
      </h2>
<p id="section-4-1">This section provides several specifications regarding the deployment of the control-plane PKI.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="deploying-a-trc">
<section id="section-4.1">
        <h3 id="name-deploying-a-trc">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-deploying-a-trc" class="section-name selfRef">Deploying a TRC</a>
        </h3>
<div id="base-trc">
<section id="section-4.1.1">
          <h4 id="name-base-trc">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-base-trc" class="section-name selfRef">Base TRC</a>
          </h4>
<p id="section-4.1.1-1">Base TRCs are trust anchors and thus axiomatically trusted. All ASes within an ISD <span class="bcp14">MUST</span> be pre-loaded with the currently valid base-version TRC of their own ISD. For all specifications regarding the creation and distribution of initial/base TRCs, see <a href="#trc-ceremony" class="auto internal xref">Section 3.2</a>.<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trc-update">
<section id="section-4.1.2">
          <h4 id="name-trc-update">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-trc-update" class="section-name selfRef">TRC Update</a>
          </h4>
<p id="section-4.1.2-1">All non-base TRCs of an ISD are updates of the ISD's base TRC(s). The TRC update chain consists of regular and sensitive TRC updates. The specifications and rules that apply to updating a TRC are described in <a href="#update" class="auto internal xref">Section 3.1.5</a>.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<div id="discover-trcupdate">
<section id="section-4.1.2.1">
            <h5 id="name-trc-update-discovery">
<a href="#section-4.1.2.1" class="section-number selfRef">4.1.2.1. </a><a href="#name-trc-update-discovery" class="section-name selfRef">TRC Update Discovery</a>
            </h5>
<p id="section-4.1.2.1-1">Relying parties <span class="bcp14">MUST</span> have at least one valid TRC available. Relying parties <span class="bcp14">MUST</span> discover TRC updates within the grace period defined in the updated TRC. They <span class="bcp14">SHOULD</span> discover TRC updates in a matter of minutes to hours. Additionally, the following requirement <span class="bcp14">MUST</span> be satisfied:<a href="#section-4.1.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2.1-2"><strong>Requirement</strong><br>
Any entity sending information that is secured by the CP-PKI <span class="bcp14">MUST</span> be able to provide all the necessary trust material to verify said information.<a href="#section-4.1.2.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1.2.1-3">SCION provides the following mechanisms for discovering TRC updates and fulfilling the above requirement:<a href="#section-4.1.2.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.2.1-4.1">
                <p id="section-4.1.2.1-4.1.1"><em>Beaconing Process</em><br>
The TRC version is announced in the beaconing process. Each AS <span class="bcp14">MUST</span> announce what it considers to be the latest TRC. Furthermore, each AS <span class="bcp14">MUST</span> include the hash value of the TRC contents to facilitate the discovery of discrepancies. Therefore, relying parties that are part of the beaconing process discover TRC updates passively. That is, a core AS notices TRC updates for remote ISDs that are on the beaconing path. A non-core AS only notices TRC updates for the local ISD through the beaconing process. The creation of a new TRC <span class="bcp14">SHOULD</span> trigger the generation of new control-plane messages, as the propagation of control-plane messages will help other ASes rapidly discover the new TRC.<a href="#section-4.1.2.1-4.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.1.2.1-4.2">
                <p id="section-4.1.2.1-4.2.1"><em>Path Lookup</em><br>
In every path segment, all ASes <span class="bcp14">MUST</span> reference the latest TRC of their ISD. Therefore, when resolving paths, every relying party will notice TRC updates, even remote ones.<br>
                  <strong>Note:</strong> The above mechanism only works when there is an active communication between the relying party and the ISD in question.<a href="#section-4.1.2.1-4.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="signing-verifying-cp-messages">
<section id="section-4.2">
        <h3 id="name-signing-and-verifying-contr">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-signing-and-verifying-contr" class="section-name selfRef">Signing and Verifying Control-Plane Messages</a>
        </h3>
<p id="section-4.2-1">SCION requires that control-plane messages are signed. The main purpose of the SCION control-plane PKI is providing a mechanism to distribute and authenticate public keys that are used to verify control-plane messages and information. For example, each hop information in a path segment is signed by the respective AS. Consequently, all relying parties <span class="bcp14">MUST</span> be able to verify signatures with the help of the CP-PKI.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">The following sections specify the requirements that apply to the signing and verification of control-plane messages.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<div id="signing-a-control-plane-message">
<section id="section-4.2.1">
          <h4 id="name-signing-a-control-plane-mes">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-signing-a-control-plane-mes" class="section-name selfRef">Signing a Control-Plane Message</a>
          </h4>
<p id="section-4.2.1-1">An AS signs control-plane messages with the private key that corresponds to the (valid) AS' certificate.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-2">The AS <span class="bcp14">MUST</span> attach the following information as signature metadata. It is the minimum information a relying party requires to identify which certificate to use to verify the signed message.<a href="#section-4.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-3.1">
              <p id="section-4.2.1-3.1.1">ISD-AS number: The ISD-AS number of the signing entity. For specification details, see <a href="#isd-as-nr" class="auto internal xref">Section 2.2.1.2.1</a>.<a href="#section-4.2.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.1-3.2">
              <p id="section-4.2.1-3.2.1">Subject key identifier: The identifier of the public key that <span class="bcp14">MUST</span> be used to verify the message. For specification details, see <a href="#subject-key-id-ext" class="auto internal xref">Section 2.2.2.2</a>.<a href="#section-4.2.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-4.2.1-4">Additionally, the signer <span class="bcp14">SHOULD</span> include the following information:<a href="#section-4.2.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1-5.1">
              <p id="section-4.2.1-5.1.1">Serial and base number of the latest TRC: Including this information allows relying parties to discover TRC updates and trust resets. For specification details, see <a href="#id" class="auto internal xref">Section 3.1.2.2.2</a>.<a href="#section-4.2.1-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-4.2.1-5.2">
              <p id="section-4.2.1-5.2.1">Timestamp: For many messages, the time at which it was signed is useful information to ensure freshness.<a href="#section-4.2.1-5.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="verifying-a-control-plane-message">
<section id="section-4.2.2">
          <h4 id="name-verifying-a-control-plane-m">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-verifying-a-control-plane-m" class="section-name selfRef">Verifying a Control-Plane Message</a>
          </h4>
<p id="section-4.2.2-1">When the relying party receives a control-plane message they want to verify, the relying party first needs to identify the certificate needed to validate the corresponding signature on the message.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.2-2">AS certificates are bundled together with the corresponding signing CA certificate into certificate chains. For efficiency, SCION distributes these certificate chains separately from the signed messages. A certificate chain is verified against the CP root certificate. However, the root certificate is <strong>not</strong> bundled in the chain, but with the TRC. This makes it possible to extend the validity period of the root certificate, and to update the corresponding TRC, without having to modify the certificate chain.<a href="#section-4.2.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2.2-3">To verify a control-plane message, the relying party <span class="bcp14">MUST</span> perform the following steps:<a href="#section-4.2.2-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2.2-4">
<li id="section-4.2.2-4.1">
              <p id="section-4.2.2-4.1.1">Build a collection of root certificates from the latest TRC of the relevant ISD (that is, the ISD referenced in the signature metadata of the message). If the grace period (see <a href="#grace" class="auto internal xref">Section 3.1.2.2.4</a>) introduced by the latest TRC is still on-going, the root certificates in the second-to-latest TRC <span class="bcp14">MUST</span> also be included. For a description on how to build the correct collection of certificates, see <a href="#trc-selection" class="auto internal xref">Section 3.1.4.1</a>.<a href="#section-4.2.2-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.2-4.2">
              <p id="section-4.2.2-4.2.1">If the signature metadata of the message contains the serial and base number of the latest TRC, the relying party <span class="bcp14">MUST</span> check that they have this latest TRC. If not, the relying party <span class="bcp14">MUST</span> request the latest TRC.<a href="#section-4.2.2-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.2.2-4.3">
              <p id="section-4.2.2-4.3.1">After constructing the pool of root certificates, the relying party <span class="bcp14">MUST</span> select the certificate chain used to verify the message. The AS certificate included in this certificate chain <span class="bcp14">MUST</span> have the following properties:<a href="#section-4.2.2-4.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.2-4.3.2.1">
                  <p id="section-4.2.2-4.3.2.1.1">The ISD-AS number in the subject of the AS certificate <span class="bcp14">MUST</span> match the ISD-AS number in the signature metadata. See also <a href="#isd-as-nr" class="auto internal xref">Section 2.2.1.2.1</a>.<a href="#section-4.2.2-4.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.2.2-4.3.2.2">
                  <p id="section-4.2.2-4.3.2.2.1">The subject key identifier of the AS certificate <span class="bcp14">MUST</span> match the subject key identifier in the signature metadata. See also <a href="#subject-key-id-ext" class="auto internal xref">Section 2.2.2.2</a>.<a href="#section-4.2.2-4.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.2.2-4.3.2.3">
                  <p id="section-4.2.2-4.3.2.3.1">The AS certificate <span class="bcp14">MUST</span> be valid at verification time. Normally, this will be the current time. In special cases, e.g., auditing, the time can be set to the past to check if the message was verifiable at the given time.<a href="#section-4.2.2-4.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li id="section-4.2.2-4.4">
              <p id="section-4.2.2-4.4.1">After selecting a certificate chain to verify the control-plane messages, the relying party <span class="bcp14">MUST</span> verify the certificate chain, by:<a href="#section-4.2.2-4.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.2-4.4.2.1">
                  <p id="section-4.2.2-4.4.2.1.1">Executing the regular X.509 verification procedure. For details, see <a href="https://handle.itu.int/11.1002/1000/13031">X.509</a>.<a href="#section-4.2.2-4.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-4.2.2-4.4.2.2">
                  <p id="section-4.2.2-4.4.2.2.1">Checking that<a href="#section-4.2.2-4.4.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.2-4.4.2.2.2.1">
                      <p id="section-4.2.2-4.4.2.2.2.1.1">all subjects of the certificates in the chain carry the same ISD number (see also <a href="#isd-as-nr" class="auto internal xref">Section 2.2.1.2.1</a>,<a href="#section-4.2.2-4.4.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-4.2.2-4.4.2.2.2.2">
                      <p id="section-4.2.2-4.4.2.2.2.2.1">each certificate is of the correct type (see also <a href="#overview" class="auto internal xref">Section 2.1</a>), and<a href="#section-4.2.2-4.4.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-4.2.2-4.4.2.2.2.3">
                      <p id="section-4.2.2-4.4.2.2.2.3.1">the CA certificate validity period covers the AS certificate validity period.<a href="#section-4.2.2-4.4.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
</li>
            <li id="section-4.2.2-4.5">
              <p id="section-4.2.2-4.5.1">If the verification of the certificate chain was successful, the relying party can now verify the control-plane messages, with the root certificates from the certificate chain.<a href="#section-4.2.2-4.5.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-4.2.2-5">If any cryptographic material is missing in the process, the relying party <span class="bcp14">MUST</span> query the originator of the message for the missing material. If it cannot be resolved, the verification process fails.<a href="#section-4.2.2-5" class="pilcrow">¶</a></p>
<p id="section-4.2.2-6"><strong>Important:</strong> An implication of the above procedure is that path segments <span class="bcp14">SHOULD</span> be verifiable at time of use. It is not enough to rely on path segments being verified on insert, since TRC updates that change the root key can invalidate a certificate chain.<a href="#section-4.2.2-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="creating-a-new-control-plane-as-certificate">
<section id="section-4.3">
        <h3 id="name-creating-a-new-control-plan">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-creating-a-new-control-plan" class="section-name selfRef">Creating a New Control-Plane AS Certificate</a>
        </h3>
<p id="section-4.3-1">The steps <span class="bcp14">REQUIRED</span> to create a new AS certificate are the following:<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3-2">
<li id="section-4.3-2.1">
            <p id="section-4.3-2.1.1">The AS creates a new key pair and a certificate signing request (CSR) using that key pair.<a href="#section-4.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.3-2.2">
            <p id="section-4.3-2.2.1">The AS sends the certificate signing request to the relevant CA within the ISD.<a href="#section-4.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.3-2.3">
            <p id="section-4.3-2.3.1">The CA uses its CA key and the CSR to create the new AS certificate.<a href="#section-4.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-4.3-2.4">
            <p id="section-4.3-2.4.1">The CA sends the AS certificate back to the AS.<a href="#section-4.3-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-4.3-3">When an AS joins an ISD, the first CSR is sent out of band to one of the CAs as part of the formalities to join the ISD. Subsequent certificate renewals <span class="bcp14">MAY</span> be automated and can leverage the control-plane communication infrastructure.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-5">
      <h2 id="name-security-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-5-1">The goal of SCION is to provide a secure inter-domain network architecture, therefore this paragraph focuses on <em>inter</em>-AS security considerations. Specifically, it covers potential attacks and mitigations for the control-plane PKI. All <em>intra</em>-AS trust- and security aspects are out of scope.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="dependency-on-certificates">
<section id="section-5.1">
        <h3 id="name-dependency-on-certificates">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-dependency-on-certificates" class="section-name selfRef">Dependency on Certificates</a>
        </h3>
<p id="section-5.1-1">In public key infrastructures, certificate authorities have both the responsibility and power to issue and revoke certificates. If a CA is compromised or malicious, this power can be abused. A misbehaving CA could refuse to issue certificates to legitimate entities, or even issue illegitimate certificates to allow impersonation of another entity. In the context of the SCION control-plane PKI, refusing to issue or renew a certificate to an AS will ultimately cut that AS off from the network, turning the CP-PKI into a potential network "kill switch". In order to prevent this, within each ISD there are usually multiple independent CAs.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">SCION’s trust architecture fundamentally differs from a global monopolistic trust model. In SCION, each ISD manages its own trust roots instead of a single global entity providing those roots. This structure gives each ISD autonomy in terms of key management and in terms of trust, and prevents the occurrence of a global kill switch affecting all ISDs at once. However, each ISD is still susceptible of compromises that could affect or halt other components (control plane and forwarding). The following sections explain these cases and possible countermeasures.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<div id="compromise-of-an-isd">
<section id="section-5.1.1">
          <h4 id="name-compromise-of-an-isd">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-compromise-of-an-isd" class="section-name selfRef">Compromise of an ISD</a>
          </h4>
<p id="section-5.1.1-1">Compared to other trust architectures, in SCION there is no central authority that could "switch off" an ISD, as each ISD relies on its own independent cryptographic trust roots. Each AS within an ISD is therefore dependant on its ISD's PKI for its functioning. This section discusses potential compromises of the PKI at various levels of the hierarchy.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.1-2.1">
              <p id="section-5.1.1-2.1.1">On TRC level: The private root keys of the root certificates contained in an TRC are used to sign CA certificates. If one of these private root keys is compromised, the adversary could issue illegitimate CA certificates which may be used in further attacks. To maliciously  perform a TRC update, an attacker would need to compromise multiple voting keys. This number depends on the voting quorum set in the TRC: the higher the quorum, the more unlikely a malicious update will be.<a href="#section-5.1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.1-2.2">
              <p id="section-5.1.1-2.2.1">On CA level: The private keys of an ISD's CA certificates are used to sign the AS certificates. All ASes within an ISD obtain certificates directly from the CAs. If one of the CA’s keys is compromised, an adversary could issue illegitimate AS certificates, which may be used in further attacks.<a href="#section-5.1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.1-2.3">
              <p id="section-5.1.1-2.3.1">On AS level: Each AS within an ISD signs control-plane messages, such as the Path Construction Beacons (PCBs) used for path discovery, with their AS private key. If the keys of an AS are compromised by an adversary, this adversary can illegitimately sign control-plane messages, including PCBs. This means that the adversary can also manipulate the PCBs, and propagate the manipulated PCBs to neighboring ASes or register/store them as path segments.<a href="#section-5.1.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="recovery-from-compromise">
<section id="section-5.1.2">
          <h4 id="name-recovery-from-compromise">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-recovery-from-compromise" class="section-name selfRef">Recovery from Compromise</a>
          </h4>
<p id="section-5.1.2-1">This section deals with possible recovery from the compromises discussed in the previous paragraph.
As described in <a href="#substitutes-to-revocation" class="auto internal xref">Section 1.4.2</a>, there is no revocation in the CP-PKI.<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.2-2.1">
              <p id="section-5.1.2-2.1.1">On TRC level: If any of the root keys or voting keys contained in the TRC are compromised, the TRC <span class="bcp14">MUST</span> be updated as described in <a href="#update" class="auto internal xref">Section 3.1.5</a>. Note that this is a sensitive TRC update, as the certificate related to the compromised private key <span class="bcp14">MUST</span> be replaced with an entirely new certificate (and not just changed). A trust reset is only required in the case the number of compromised  keys at the same time is greater or equal than the TRC's quorum (see <a href="#quorum" class="auto internal xref">Section 3.1.2.2.7</a>).<a href="#section-5.1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.2-2.2">
              <p id="section-5.1.2-2.2.1">On CA level: If the private key related to a CA certificate is compromised, the impacted CA AS <span class="bcp14">MUST</span> obtain a new CA certificate from the corresponding root AS. CA certificates are generally short lived to limit the impact of compromise. Alternatively, with a TRC update, a new root keys can also be forced, invalidating the compromised CA.<a href="#section-5.1.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.1.2-2.3">
              <p id="section-5.1.2-2.3.1">On AS level: In the event of a key compromise of a (non-core) AS, the impacted AS needs to obtain a new certificate from its CA. This process will vary depending on internal issuance protocols.<a href="#section-5.1.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="denial-of-service-attacks">
<section id="section-5.2">
        <h3 id="name-denial-of-service-attacks">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-denial-of-service-attacks" class="section-name selfRef">Denial of Service Attacks</a>
        </h3>
<p id="section-5.2-1">As described previously, the SCION's control-plane PKI lays the foundation for the authentication procedures in SCION. It provides each AS within a specific ISD with a certified key pair. These keys enable the authentication of all control-plane messages - every AS and endpoint can verify all control-plane messages by following the certificate chain.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">The relying party <span class="bcp14">MUST</span> be able to discover and obtain new or updated cryptographic material. For the control plane messages, this is simplified by the observation that the sender of a message (e.g. of a path construction beacon during path exploration or a path segment during a path lookup) always has all the cryptographic material to verify it. Thus, the receiver can always immediately obtain all the cryptographic material from the message originator.
As the corresponding PKI messaging thus only occurs when the control plane is already communicating, these requests to obtain cryptographic material are not prone to additional denial of service attacks. We therefore refer to <span>[<a href="#I-D.scion-cp" class="cite xref">I-D.scion-cp</a>]</span> for a more detailed description of DoS vulnerabilities of control-plane messages.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">For certificate renewal, on the other hand, this does not apply.
Denial of Service on the CA infrastructure or on the communication links from the individual ASes to the CA, could be used by an attacker to prevent victim ASes from renewing their certificates, halting the path discovery process.
This risk can be mitigated in multiple ways:<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-4.1">
            <p id="section-5.2-4.1.1">CAs only need to be accessible from ASes within the ISD, reducing the potential DoS attack surface<a href="#section-5.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.2-4.2">
            <p id="section-5.2-4.2.1">ISDs usually rely on multiple CAs<a href="#section-5.2-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.2-4.3">
            <p id="section-5.2-4.3.1">ISDs could create policies and processes to renew certificates out-of-band<a href="#section-5.2-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-6-1">This document has no IANA actions.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The SCION AS and ISD number are SCION-specific numbers. They are currently allocated by Anapaya Systems, a provider of SCION-based networking software and solutions (see <a href="https://docs.anapaya.net/en/latest/resources/isd-as-assignments/">Anapaya ISD AS assignments</a>). This task is currently being transitioned from Anapaya to the SCION Association.<a href="#section-6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-7">
      <h2 id="name-references">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-7.1">
        <h3 id="name-normative-references">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.scion-cp">[I-D.scion-cp]</dt>
        <dd>
<span class="refAuthor">de Kater, C.</span>, <span class="refAuthor">Rustignoli, N.</span>, and <span class="refAuthor">S. Hitz</span>, <span class="refTitle">"SCION Control Plane"</span>, <time datetime="2023" class="refDate">2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/draft-dekater-scion-controlplane/">https://datatracker.ietf.org/doc/draft-dekater-scion-controlplane/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.scion-dataplane">[I-D.scion-dataplane]</dt>
        <dd>
<span class="refAuthor">de Kater, C.</span>, <span class="refAuthor">Rustignoli, N.</span>, and <span class="refAuthor">S. Hitz</span>, <span class="refTitle">"SCION Data Plane"</span>, <time datetime="2023" class="refDate">2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/draft-dekater-scion-dataplane/">https://datatracker.ietf.org/doc/draft-dekater-scion-dataplane/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5480">[RFC5480]</dt>
        <dd>
<span class="refAuthor">Turner, S.</span>, <span class="refAuthor">Brown, D.</span>, <span class="refAuthor">Yiu, K.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">T. Polk</span>, <span class="refTitle">"Elliptic Curve Cryptography Subject Public Key Information"</span>, <span class="seriesInfo">RFC 5480</span>, <span class="seriesInfo">DOI 10.17487/RFC5480</span>, <time datetime="2009-03" class="refDate">March 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5480">https://www.rfc-editor.org/rfc/rfc5480</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5652">[RFC5652]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">STD 70</span>, <span class="seriesInfo">RFC 5652</span>, <span class="seriesInfo">DOI 10.17487/RFC5652</span>, <time datetime="2009-09" class="refDate">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5652">https://www.rfc-editor.org/rfc/rfc5652</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5758">[RFC5758]</dt>
        <dd>
<span class="refAuthor">Dang, Q.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Moriarty, K.</span>, <span class="refAuthor">Brown, D.</span>, and <span class="refAuthor">T. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure: Additional Algorithms and Identifiers for DSA and ECDSA"</span>, <span class="seriesInfo">RFC 5758</span>, <span class="seriesInfo">DOI 10.17487/RFC5758</span>, <time datetime="2010-01" class="refDate">January 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5758">https://www.rfc-editor.org/rfc/rfc5758</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9217">[RFC9217]</dt>
      <dd>
<span class="refAuthor">Trammell, B.</span>, <span class="refTitle">"Current Open Questions in Path-Aware Networking"</span>, <span class="seriesInfo">RFC 9217</span>, <span class="seriesInfo">DOI 10.17487/RFC9217</span>, <time datetime="2022-03" class="refDate">March 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9217">https://www.rfc-editor.org/rfc/rfc9217</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-7.2">
        <h3 id="name-informative-references">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="BARRERA17">[BARRERA17]</dt>
        <dd>
<span class="refAuthor">Barrera, D.</span>, <span class="refAuthor">Chuat, L.</span>, <span class="refAuthor">Perrig, A.</span>, <span class="refAuthor">Reischuk, R.</span>, and <span class="refAuthor">P. Szalachowski</span>, <span class="refTitle">"The SCION internet architecture"</span>, <span class="refContent">Association for Computing Machinery (ACM)</span>, <span class="seriesInfo">Communications of the ACM vol. 60, no. 6, pp. 56-65</span>, <span class="seriesInfo">DOI 10.1145/3085591</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://doi.org/10.1145/3085591">https://doi.org/10.1145/3085591</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CHUAT22">[CHUAT22]</dt>
        <dd>
<span class="refAuthor">Chuat, L.</span>, <span class="refAuthor">Legner, M.</span>, <span class="refAuthor">Basin, D.</span>, <span class="refAuthor">Hausheer, D.</span>, <span class="refAuthor">Hitz, S.</span>, <span class="refAuthor">Mueller, P.</span>, and <span class="refAuthor">A. Perrig</span>, <span class="refTitle">"The Complete Guide to SCION"</span>, <span class="seriesInfo">ISBN 978-3-031-05287-3</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://doi.org/10.1007/978-3-031-05288-0">https://doi.org/10.1007/978-3-031-05288-0</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5398">[RFC5398]</dt>
        <dd>
<span class="refAuthor">Huston, G.</span>, <span class="refTitle">"Autonomous System (AS) Number Reservation for Documentation Use"</span>, <span class="seriesInfo">RFC 5398</span>, <span class="seriesInfo">DOI 10.17487/RFC5398</span>, <time datetime="2008-12" class="refDate">December 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5398">https://www.rfc-editor.org/rfc/rfc5398</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6996">[RFC6996]</dt>
      <dd>
<span class="refAuthor">Mitchell, J.</span>, <span class="refTitle">"Autonomous System (AS) Reservation for Private Use"</span>, <span class="seriesInfo">BCP 6</span>, <span class="seriesInfo">RFC 6996</span>, <span class="seriesInfo">DOI 10.17487/RFC6996</span>, <time datetime="2013-07" class="refDate">July 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6996">https://www.rfc-editor.org/rfc/rfc6996</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">Many thanks go to Fritz Steinmann (SIX Group AG), Juan A. Garcia Prado (ETH Zurich) and Russ Housley (IETF) for reviewing this document. We are also very grateful to Adrian Perrig (ETH Zurich), for providing guidance and feedback about each aspect of SCION. Finally, we are indebted to the SCION development teams of Anapaya and ETH Zurich, for their practical knowledge and for the documentation about the CP PKI, as well as to the authors of <span>[<a href="#CHUAT22" class="cite xref">CHUAT22</a>]</span> - the book is an important source of input and inspiration for this draft.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="initial-ceremony">
<section id="appendix-B">
      <h2 id="name-appendix-a-signing-ceremony">
<a href="#name-appendix-a-signing-ceremony" class="section-name selfRef">Appendix A. Signing Ceremony Initial TRC</a>
      </h2>
<p id="appendix-B-1">The following sections describe a possible signing ceremony for the first (initial) base TRC of an ISD. Although each ISD is free to decide how to shape this signing ceremony, it is recommended establishing a procedure similar to the one below.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<div id="ceremony-participants">
<section id="appendix-B.1">
        <h3 id="name-ceremony-participants">
<a href="#name-ceremony-participants" class="section-name selfRef">Ceremony Participants</a>
        </h3>
<p id="appendix-B.1-1">A signing ceremony includes participants from member organizations of the respective Isolation Domain.
The participants of the signing ceremony fulfill different roles:<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.1-2.1">
            <p id="appendix-B.1-2.1.1">The <strong>ceremony administrator</strong> is in charge of moderating the signing process. He/she guides all participants through the steps they need to take. The ceremony administrator may also act as an intermediary between participants when they share information with each other.<a href="#appendix-B.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-2.2">
            <p id="appendix-B.1-2.2.1">A <strong>voting AS representative</strong> is capable of creating voting signatures on the TRC. This means the voting representative is in possession of a device with the private keys of the respective certificates in the TRC.<a href="#appendix-B.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.1-2.3">
            <p id="appendix-B.1-2.3.1">A <strong>witness</strong> is any person that participates in the ceremony as a passive entity. The witness has no active role in any of the steps of the ceremony, but can stop the process and inquire for more information if they feel the integrity of the process might have been compromised.<a href="#appendix-B.1-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-B.1-3"><strong>Note:</strong> It is assumed that the member organizations of the ISD have decided in advance, before the signing ceremony, on the roles of the ceremony participants. That is, they have reached agreement about the Certificate Authority (CA) ASes (that will also issue the root certificates), the voting ASes, the representatives of the voting ASes, the ceremony administrator and the witnesses.<a href="#appendix-B.1-3" class="pilcrow">¶</a></p>
<p id="appendix-B.1-4"><strong>Note:</strong> For the signing ceremony, it is assumed that all parties are trustworthy. Issues encountered during the ceremony are assumed to be caused by honest mistakes, and not by malicious intent. Hash comparison checks are included to counter mistakes, such that every participant is sure that they operate on the same data. Furthermore, the private keys of each participant never leave their machine. The ceremony administrator does not have to be entrusted with private keys.<a href="#appendix-B.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ceremony-preparations">
<section id="appendix-B.2">
        <h3 id="name-ceremony-preparations">
<a href="#name-ceremony-preparations" class="section-name selfRef">Ceremony Preparations</a>
        </h3>
<p id="appendix-B.2-1">Prior to the ceremony, participants decide on the physical location of the ceremony, the devices that will be used during the ceremony and the policy of the ISD. Specifically, the voting entities agree on the following parameters:<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.2-2.1">
            <p id="appendix-B.2-2.1.1">validity of the TRC,<a href="#appendix-B.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-2.2">
            <p id="appendix-B.2-2.2.1">voting quorum,<a href="#appendix-B.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-2.3">
            <p id="appendix-B.2-2.3.1">core ASes/authoritative ASes,<a href="#appendix-B.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-2.4">
            <p id="appendix-B.2-2.4.1">description, and<a href="#appendix-B.2-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.2-2.5">
            <p id="appendix-B.2-2.5.1">list of CP root certificates.<a href="#appendix-B.2-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-B.2-3">When these values are agreed upon, a number of voters, equal to or larger than the specified voting quorum, needs to execute the signing ceremony. For the base TRC, all voting entities need to be present with both their sensitive and regular voting keys. The ceremony process is structured in multiple rounds of data sharing. The ceremony administrator leads the interaction and gives instructions to each participant.<a href="#appendix-B.2-3" class="pilcrow">¶</a></p>
<div id="location">
<section id="appendix-B.2.1">
          <h4 id="name-location">
<a href="#name-location" class="section-name selfRef">Location</a>
          </h4>
<p id="appendix-B.2.1-1">The location must provide electricity and enough power sockets for each participant. Furthermore, it should provide a monitor (or projector) that allows the ceremony administrator to screencast.<a href="#appendix-B.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="devices">
<section id="appendix-B.2.2">
          <h4 id="name-devices">
<a href="#name-devices" class="section-name selfRef">Devices</a>
          </h4>
<p id="appendix-B.2.2-1">Each party brings their own device that is provisioned with the required material, as described below.<a href="#appendix-B.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.2.2-2.1">
              <p id="appendix-B.2.2-2.1.1">Device to exchange data. This device can either be provided by the ceremony administrator, or, if preferable, by any of the voting representatives.<a href="#appendix-B.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-B.2.2-2.2">
              <p id="appendix-B.2.2-2.2.1">Ceremony administrator's device: The ceremony administrator should bring a machine that is capable of creating and verifying a TRC. Furthermore, it needs to be able to compute the SHA-512 digest (hash value) of files.<a href="#appendix-B.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-B.2.2-2.3">
              <p id="appendix-B.2.2-2.3.1">Voting representative's device: The voting representative should bring a machine that is capable of signing and verifying TRCs. Thus, the machine needs to have access to all the voting private keys. Furthermore, it needs to be able to compute the SHA-512 digest (hash value) of the files. The exact binaries that are required are described in a separate document.<a href="#appendix-B.2.2-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="appendix-B.2.2-3">It is very important that all devices, especially the data exchange device, are not compromised. Therefore, the ceremony should ideally include a procedure to verify that the devices are secure.<a href="#appendix-B.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="preparation-steps">
<section id="appendix-B.2.3">
          <h4 id="name-preparation-steps">
<a href="#name-preparation-steps" class="section-name selfRef">Preparation Steps</a>
          </h4>
<p id="appendix-B.2.3-1">Each party involved in a TRC signing ceremony <span class="bcp14">MUST</span> go through a few steps in preparation for the ceremony. This section outlines these steps.<a href="#appendix-B.2.3-1" class="pilcrow">¶</a></p>
<div id="preparatory-tasks-of-the-ceremony-administrator">
<section id="appendix-B.2.3.1">
            <h5 id="name-preparatory-tasks-of-the-ce">
<a href="#name-preparatory-tasks-of-the-ce" class="section-name selfRef">Preparatory Tasks of the Ceremony Administrator</a>
            </h5>
<p id="appendix-B.2.3.1-1">In the preparation phase of the TRC Signing Ceremony, the ceremony administrator has the following tasks:<a href="#appendix-B.2.3.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-B.2.3.1-2">
<li id="appendix-B.2.3.1-2.1">
                <p id="appendix-B.2.3.1-2.1.1">Send out the high-level TRC Signing Ceremony description and the document describing the TRC Signing Ceremony Phases to the participants, all in digital form.<a href="#appendix-B.2.3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="appendix-B.2.3.1-2.2">
                <p id="appendix-B.2.3.1-2.2.1">Remind all representatives of the voting ASes that they need to agree on a common TRC policy before scheduling the TRC ceremony.<a href="#appendix-B.2.3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li id="appendix-B.2.3.1-2.3">
                <p id="appendix-B.2.3.1-2.3.1">Bring all digitally distributed documents as a printout for all parties that take part.<a href="#appendix-B.2.3.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            </ol>
</section>
</div>
<div id="preparatory-tasks-of-the-voting-as-representatives">
<section id="appendix-B.2.3.2">
            <h5 id="name-preparatory-tasks-of-the-vo">
<a href="#name-preparatory-tasks-of-the-vo" class="section-name selfRef">Preparatory Tasks of the Voting AS Representatives</a>
            </h5>
<p id="appendix-B.2.3.2-1">The preparatory task of the representatives of the voting ASes (short: the voters) is to generate the necessary certificates.<a href="#appendix-B.2.3.2-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2.3.2-2"><strong>Important:</strong> Before generating the certificates, all voters need to agree on a preliminary TRC policy, in particular on the <strong>validity period of the TRC</strong>. This is necessary because all the certificates that are generated in advance <span class="bcp14">MUST</span> <strong>cover the full TRC validity period</strong>. The other policy values could be amended during the ceremony itself.<a href="#appendix-B.2.3.2-2" class="pilcrow">¶</a></p>
<p id="appendix-B.2.3.2-3">Each representative of a voting AS <span class="bcp14">MUST</span> create the following keys and certificates:<a href="#appendix-B.2.3.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.2.3.2-4.1">
                <p id="appendix-B.2.3.2-4.1.1">A sensitive voting private key, and a certificate holding the corresponding public key.<a href="#appendix-B.2.3.2-4.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-B.2.3.2-4.2">
                <p id="appendix-B.2.3.2-4.2.1">A regular voting private key, and a certificate holding the corresponding public key.<a href="#appendix-B.2.3.2-4.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="preparatory-tasks-of-the-certificate-authority-ases">
<section id="appendix-B.2.3.3">
            <h5 id="name-preparatory-tasks-of-the-cer">
<a href="#name-preparatory-tasks-of-the-cer" class="section-name selfRef">Preparatory Tasks of the Certificate Authority ASes</a>
            </h5>
<p id="appendix-B.2.3.3-1">Each AS that will be a Certificate Authority (a so-called CA AS) <span class="bcp14">MUST</span> ensure that the following key and certificate is available:<a href="#appendix-B.2.3.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.2.3.3-2.1">
                <p id="appendix-B.2.3.3-2.1.1">A control-plane root private key, and a certificate holding the corresponding public key.<a href="#appendix-B.2.3.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="appendix-B.2.3.3-3">This implies that there will be one control-plane root certificate per CA AS.<a href="#appendix-B.2.3.3-3" class="pilcrow">¶</a></p>
<p id="appendix-B.2.3.3-4"><strong>Note</strong>: Representatives of CA ASes need not be present at the signing ceremony themselves as they do not have to put a signature on the TRC. However, if a CA AS does not attend the signing ceremony in person, it <span class="bcp14">MUST</span> ensure that the corresponding root certificate is available at the ceremony to be shared.<a href="#appendix-B.2.3.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ceremony-process">
<section id="appendix-B.3">
        <h3 id="name-ceremony-process">
<a href="#name-ceremony-process" class="section-name selfRef">Ceremony Process</a>
        </h3>
<p id="appendix-B.3-1">The ceremony process for the initial base TRC is structured in multiple rounds of data sharing. The ceremony administrator leads the interaction and instructs each participant with what to do.<a href="#appendix-B.3-1" class="pilcrow">¶</a></p>
<p id="appendix-B.3-2">The ceremony process contains the following phases:<a href="#appendix-B.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.3-3.1">
            <p id="appendix-B.3-3.1.1"><span><a href="#phase1" class="internal xref">Phase 1: Certificate Exchange</a> (<a href="#phase1" class="auto internal xref">Appendix "Phase 1: Certificate Exchange"</a>)</span>. In the first phase of the ceremony, all voting parties share the certificates that must be part of the TRC with the ceremony administrator.<a href="#appendix-B.3-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.3-3.2">
            <p id="appendix-B.3-3.2.1"><span><a href="#phase2" class="internal xref">Phase 2: Generation of the TRC Payload</a> (<a href="#phase2" class="auto internal xref">Appendix "Phase 2: Generation of the TRC Payload"</a>)</span>. In the second phase, the ceremony administrator generates the TRC payload based on the bundled certificates and the agreed-upon ISD policy.<a href="#appendix-B.3-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.3-3.3">
            <p id="appendix-B.3-3.3.1"><span><a href="#phase3" class="internal xref">Phase 3: TRC Signing</a> (<a href="#phase3" class="auto internal xref">Appendix "Phase 3: TRC Signing"</a>)</span>. In the third phase, each voting representative attaches the required signatures to the TRC.<a href="#appendix-B.3-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-B.3-3.4">
            <p id="appendix-B.3-3.4.1"><span><a href="#phase4" class="internal xref">Phase 4: TRC Validation</a> (<a href="#phase4" class="auto internal xref">Appendix "Phase 4: TRC Validation"</a>)</span>. In the final phase of the ceremony, all voting representatives share the signed TRC with the ceremony administrator, who aggregates it in a single signed TRC document.<a href="#appendix-B.3-3.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-B.3-4">A detailed description of each phase follows below.<a href="#appendix-B.3-4" class="pilcrow">¶</a></p>
<div id="phase1">
<section id="appendix-B.3.1">
          <h4 id="name-phase-1-certificate-exchang">
<a href="#name-phase-1-certificate-exchang" class="section-name selfRef">Phase 1: Certificate Exchange</a>
          </h4>
<p id="appendix-B.3.1-1">In Phase 1 of the signing ceremony, all parties share the certificates that must be part of the TRC with the ceremony administrator. For the representatives of the voting ASes, these are the sensitive and the regular voting certificates. For the representatives of the CA ASes, these are the CP root certificates. If a CA AS does not attend the signing ceremony in person, it <span class="bcp14">MUST</span> ensure that the corresponding root certificate is available at the ceremony to be shared.<a href="#appendix-B.3.1-1" class="pilcrow">¶</a></p>
<p id="appendix-B.3.1-2">The actual sharing happens over the data exchange device, which goes from one voting representative to the next. Each representative copies the requested certificates from their own machine onto the data exchange device, before forwarding the device to the next voter. The last representative returns the device to the ceremony administrator.<a href="#appendix-B.3.1-2" class="pilcrow">¶</a></p>
<p id="appendix-B.3.1-3"><strong>Important:</strong> Note that only the <strong>certificates</strong> need to be shared during this step, <strong>not</strong> the private keys. Copying a private key by mistake invalidates the security of the ceremony.<a href="#appendix-B.3.1-3" class="pilcrow">¶</a></p>
<p id="appendix-B.3.1-4">For each provided certificate, the ceremony administrator checks that its validity period covers the previously agreed-upon TRC validity, that the signature algorithms are correct, and that the certificate is of the valid type (root, sensitive voting or regular voting certificate). If the results of these checks are as expected, the ceremony administrator computes the SHA256 sum for each certificate.<a href="#appendix-B.3.1-4" class="pilcrow">¶</a></p>
<p id="appendix-B.3.1-5">The ceremony administrator then aggregates and bundles the provided certificates, and calculates the hash value (SHA-512 digest) over the entire bundle. Additionally, the ceremony administrator displays all hash values on the monitor.<a href="#appendix-B.3.1-5" class="pilcrow">¶</a></p>
<p id="appendix-B.3.1-6">The ceremony administrator now shares the bundle with the representatives of the voting and CA ASes. This could happen again via the data exchange device, which goes from one representative to the next. Each representative verifies that the certificates they contributed have the same hash value as the displayed value on the monitor. Furthermore, all representatives <span class="bcp14">MUST</span> confirm that the hash value of the bundled certificates on their machine is equal to the value on the monitor.<a href="#appendix-B.3.1-6" class="pilcrow">¶</a></p>
<p id="appendix-B.3.1-7">Phase 1 is concluded when every representative has confirmed that the SHA256 sums are correct.<a href="#appendix-B.3.1-7" class="pilcrow">¶</a></p>
<p id="appendix-B.3.1-8"><strong>Note:</strong> If there is a mismatch in any of the SHA256 sums, Phase 1 needs to be repeated.<a href="#appendix-B.3.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="phase2">
<section id="appendix-B.3.2">
          <h4 id="name-phase-2-generation-of-the-t">
<a href="#name-phase-2-generation-of-the-t" class="section-name selfRef">Phase 2: Generation of the TRC Payload</a>
          </h4>
<p id="appendix-B.3.2-1">In Phase 2 of the ceremony, the ceremony administrator generates the TRC payload based on the bundled certificates and the agreed-upon ISD policy. The result is displayed on the monitor along with a hash value (SHA-512 digest).<a href="#appendix-B.3.2-1" class="pilcrow">¶</a></p>
<p id="appendix-B.3.2-2">To be able to generate the payload, the ceremony administrator <span class="bcp14">MUST</span> ask the voting representatives for:<a href="#appendix-B.3.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B.3.2-3.1">
              <p id="appendix-B.3.2-3.1.1">The ISD number of the ISD. The number (identifier, ID) of an ISD <span class="bcp14">MUST</span> be chosen and agreed upon by the participants during the signing ceremony of the ISD's initial TRC. The ceremony administrator needs the ISD number to specify the identifier (ID) of the initial TRC. This <code>iD</code> is part of the TRC payload. For more information, see <a href="#id" class="auto internal xref">Section 3.1.2.2.2</a>.<a href="#appendix-B.3.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-B.3.2-3.2">
              <p id="appendix-B.3.2-3.2.1">The description of the TRC. For more information, see <a href="#description" class="auto internal xref">Section 3.1.2.2.10</a>.<a href="#appendix-B.3.2-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-B.3.2-3.3">
              <p id="appendix-B.3.2-3.3.1">The AS numbers of the core ASes of the ISD. For more information, see <a href="#core" class="auto internal xref">Section 3.1.2.2.8</a>.<a href="#appendix-B.3.2-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-B.3.2-3.4">
              <p id="appendix-B.3.2-3.4.1">The AS numbers of the authoritative ASes of the ISD. For more information, see <a href="#auth" class="auto internal xref">Section 3.1.2.2.9</a>.<a href="#appendix-B.3.2-3.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-B.3.2-3.5">
              <p id="appendix-B.3.2-3.5.1">The voting quorum for the next TRC update. For more information, see <a href="#quorum" class="auto internal xref">Section 3.1.2.2.7</a>.<a href="#appendix-B.3.2-3.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="appendix-B.3.2-3.6">
              <p id="appendix-B.3.2-3.6.1">The validity period of the new TRC. For more information, see <a href="#validity" class="auto internal xref">Section 3.1.2.2.3</a>.<a href="#appendix-B.3.2-3.6.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="appendix-B.3.2-4"><strong>Note:</strong> It is assumed that the voting ASes have agreed on the answers to the above questions in advance, before the signing ceremony.<a href="#appendix-B.3.2-4" class="pilcrow">¶</a></p>
<p id="appendix-B.3.2-5">The ceremony administrator can now specify the TRC payload variables in the payload template file, and show the filled-in template on the monitor. When the voters have verified the data, the ceremony administrator can compute the DER encoding of the TRC data as well as the SHA256 sum of the TRC payload file. The ceremony administrator then distributes the TRC payload (via the data exchange device) to all voting representatives, who verify the payload's hash value. The voters do this by computing the hash value of the TRC payload on their machine and checking whether their value matches the one on the monitor.<a href="#appendix-B.3.2-5" class="pilcrow">¶</a></p>
<p id="appendix-B.3.2-6">Phase 2 successfully concludes once every voting representative confirms that the contents of the TRC payload are correct.<a href="#appendix-B.3.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="phase3">
<section id="appendix-B.3.3">
          <h4 id="name-phase-3-trc-signing">
<a href="#name-phase-3-trc-signing" class="section-name selfRef">Phase 3: TRC Signing</a>
          </h4>
<p id="appendix-B.3.3-1">In Phase 3, each voting representative attaches a signature created with each one of their private voting keys to the TRC (payload file). They do this on their own machine. The purpose of signing a TRC that contains newly introduced public keys with the corresponding private keys is to prove the possession of the private keys.<a href="#appendix-B.3.3-1" class="pilcrow">¶</a></p>
<p id="appendix-B.3.3-2">Phase 3 concludes after all voting representatives have cast their votes.<a href="#appendix-B.3.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="phase4">
<section id="appendix-B.3.4">
          <h4 id="name-phase-4-trc-validation">
<a href="#name-phase-4-trc-validation" class="section-name selfRef">Phase 4: TRC Validation</a>
          </h4>
<p id="appendix-B.3.4-1">In Phase 4, all voting representatives share the signed TRC with the ceremony administrator. This happens again over the data exchange device, which goes from one voter to the next. Each voting representative copies the TRC payload signed with the voter's private keys from their own machine onto the data exchange device. The last voter returns the device to the ceremony administrator, who assembles the final TRC by aggregating the payload data with the votes (signatures) cast by the voting representatives.<a href="#appendix-B.3.4-1" class="pilcrow">¶</a></p>
<p id="appendix-B.3.4-2">The signed TRC is validated by inspecting its contents on the monitor and verifying the signatures based on the exchanged certificates in Phase 1. The ceremony administrator then shares the signed TRC with all participants. Each of them <span class="bcp14">MUST</span> then inspect it once more, and verify it based on the certificates exchanged in Phase 1. At this point, the ceremony is completed. All participants have the signed TRC, and can use it to distribute the trust anchors for their ISD.<a href="#appendix-B.3.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="change-log">
<section id="appendix-C">
      <h2 id="name-change-log">
<a href="#name-change-log" class="section-name selfRef">Change Log</a>
      </h2>
<p id="appendix-C-1">Changes made to drafts since ISE submission. This section is to be removed before publication.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<div id="draft-dekater-scion-pki-07">
<section id="appendix-C.1">
        <h3 id="name-draft-dekater-scion-pki-07">
<a href="#name-draft-dekater-scion-pki-07" class="section-name selfRef">draft-dekater-scion-pki-07</a>
        </h3>
<p id="appendix-C.1-1">Minor changes:<a href="#appendix-C.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.1-2.1">
            <p id="appendix-C.1-2.1.1">Added Ceremony &amp; Deployment process.<a href="#appendix-C.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-2.2">
            <p id="appendix-C.1-2.2.1">Added Trusted Root Configuration (TRC) Specification.<a href="#appendix-C.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-2.3">
            <p id="appendix-C.1-2.3.1">Added Certificate Specification.<a href="#appendix-C.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-2.4">
            <p id="appendix-C.1-2.4.1">Clarified relationship with RPKI.<a href="#appendix-C.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-2.5">
            <p id="appendix-C.1-2.5.1">Added this changelog<a href="#appendix-C.1-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.1-2.6">
            <p id="appendix-C.1-2.6.1">General text editing<a href="#appendix-C.1-2.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="draft-dekater-scion-pki-06">
<section id="appendix-C.2">
        <h3 id="name-draft-dekater-scion-pki-06">
<a href="#name-draft-dekater-scion-pki-06" class="section-name selfRef">draft-dekater-scion-pki-06</a>
        </h3>
<p id="appendix-C.2-1">Major changes:<a href="#appendix-C.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.2-2.1">
            <p id="appendix-C.2-2.1.1">Added overview of SCION components to Introduction section.<a href="#appendix-C.2-2.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="appendix-C.2-3">Minor changes:<a href="#appendix-C.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.2-4.1">
            <p id="appendix-C.2-4.1.1">General edits to make terminology consistent, remove duplication and rationalize text.<a href="#appendix-C.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-4.2">
            <p id="appendix-C.2-4.2.1">Removed forward references.<a href="#appendix-C.2-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.2-4.3">
            <p id="appendix-C.2-4.3.1">Added RFC2119 compliant terminology.<a href="#appendix-C.2-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Corine de Kater</span></div>
<div dir="auto" class="left"><span class="org">SCION Association</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:c_de_kater@gmx.ch" class="email">c_de_kater@gmx.ch</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Nicola Rustignoli</span></div>
<div dir="auto" class="left"><span class="org">SCION Association</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:nic@scion.org" class="email">nic@scion.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Samuel Hitz</span></div>
<div dir="auto" class="left"><span class="org">Anapaya Systems</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:hitz@anapaya.net" class="email">hitz@anapaya.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
